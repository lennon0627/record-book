<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‚¹å‘¼è¨˜éŒ²ç°¿</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .login-container {
            padding: 60px 30px;
            text-align: center;
        }

        .login-btn {
            background: white;
            color: #5a67d8;
            border: 2px solid #5a67d8;
            padding: 15px 40px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .login-btn:hover {
            background: #5a67d8;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(90, 103, 216, 0.3);
        }

        .content {
            padding: 30px;
        }

        .user-info {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .user-name {
            font-weight: 600;
            color: #2d3748;
        }

        .logout-btn {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: #c53030;
            transform: translateY(-2px);
        }

        .form-section {
            background: #f7fafc;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .form-section h2 {
            color: #2d3748;
            font-size: 20px;
            margin-bottom: 20px;
            border-bottom: 3px solid #5a67d8;
            padding-bottom: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 8px;
            font-size: 14px;
        }

        input, select, textarea {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #5a67d8;
            box-shadow: 0 0 0 3px rgba(90, 103, 216, 0.1);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 150px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(90, 103, 216, 0.3);
        }

        .btn-secondary {
            background: #48bb78;
            color: white;
        }

        .btn-secondary:hover {
            background: #38a169;
            transform: translateY(-2px);
        }

        .btn-tertiary {
            background: #ed8936;
            color: white;
        }

        .btn-tertiary:hover {
            background: #dd6b20;
            transform: translateY(-2px);
        }

        .records-list {
            margin-top: 30px;
        }

        .record-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 5px solid #5a67d8;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .record-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .record-date {
            font-weight: 700;
            color: #2d3748;
            font-size: 16px;
        }

        .record-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 15px;
            font-size: 13px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-edit {
            background: #4299e1;
            color: white;
        }

        .btn-edit:hover {
            background: #3182ce;
        }

        .btn-delete {
            background: #f56565;
            color: white;
        }

        .btn-delete:hover {
            background: #e53e3e;
        }

        .record-details {
            color: #718096;
            font-size: 14px;
            line-height: 1.6;
        }

        .month-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .month-selector select {
            flex: 1;
            min-width: 150px;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #718096;
        }

        .tabs {
            display: flex;
            gap: 0;
            margin-bottom: 30px;
            border-bottom: 3px solid #e2e8f0;
            overflow-x: auto;
        }

        .tab-button {
            padding: 15px 30px;
            background: transparent;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            color: #718096;
            border-bottom: 3px solid transparent;
            margin-bottom: -3px;
            transition: all 0.3s;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .tab-button:hover {
            color: #5a67d8;
            background: #f7fafc;
        }

        .tab-button.active {
            color: #5a67d8;
            border-bottom-color: #5a67d8;
            background: #f7fafc;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .tabs {
                border-bottom: 2px solid #e2e8f0;
            }

            .tab-button {
                padding: 12px 20px;
                font-size: 14px;
                border-bottom: 2px solid transparent;
                margin-bottom: -2px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Firebaseè¨­å®š
        const firebaseConfig = {
            apiKey: "AIzaSyDjAfZXyrzQlHIT8qpj0vynIznrJDFcUe4",
            authDomain: "tenko-kiroku.firebaseapp.com",
            projectId: "tenko-kiroku",
            storageBucket: "tenko-kiroku.firebasestorage.app",
            messagingSenderId: "67100796956",
            appId: "1:67100796956:web:c57a2f0449e0a766a217d9",
            measurementId: "G-CDJNEZ5LWX"
        };

        // FirebaseåˆæœŸåŒ–
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }

        function App() {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [records, setRecords] = useState([]);
            const [editingId, setEditingId] = useState(null);
            const [activeTab, setActiveTab] = useState('input'); // 'input', 'bulk', 'list'
            
            // ä¸€æ‹¬æ“ä½œç”¨ã®state
            const [bulkMonth, setBulkMonth] = useState(new Date().toISOString().slice(0, 7));
            const [excludeDays, setExcludeDays] = useState([0]); // 0=æ—¥æ›œæ—¥
            const [excludeDates, setExcludeDates] = useState([]);
            
            // ãƒ•ã‚©ãƒ¼ãƒ ã®çŠ¶æ…‹
            const [formData, setFormData] = useState({
                date: new Date().toISOString().split('T')[0],
                companyName: '',
                officeName: '',
                driverName: '',
                vehicleNumber: '',
                // æ¥­å‹™å‰ç‚¹å‘¼
                beforeTime: '',
                beforeMethod: 'å¯¾é¢',
                beforeExecutor: '',
                beforeAlcoholTest: 'æœ‰',
                beforeAlcohol: 'ç„¡',
                beforeHealth: 'è‰¯å¥½',
                beforeInspection: 'è‰¯å¥½',
                beforeWeather: 'æ™´',
                beforeOther: '',
                // æ¥­å‹™å¾Œç‚¹å‘¼
                afterTime: '',
                afterMethod: 'å¯¾é¢',
                afterExecutor: '',
                afterAlcoholTest: 'æœ‰',
                afterAlcohol: 'ç„¡',
                afterStatus: 'ç•°å¸¸ãªã—',
                afterHandover: 'ãªã—',
                afterOther: ''
            });

            // Firestoreã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
            const loadRecords = async (userId) => {
                try {
                    const snapshot = await firebase.firestore()
                        .collection('records')
                        .where('userId', '==', userId)
                        .orderBy('date', 'desc')
                        .get();
                    
                    const loadedRecords = [];
                    snapshot.forEach(doc => {
                        loadedRecords.push({ id: doc.id, ...doc.data() });
                    });
                    setRecords(loadedRecords);

                    // å…¥åŠ›ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’èª­ã¿è¾¼ã‚€
                    const templateDoc = await firebase.firestore()
                        .collection('userTemplates')
                        .doc(userId)
                        .get();
                    
                    if (templateDoc.exists) {
                        const template = templateDoc.data();
                        setFormData(prev => ({
                            ...template,
                            date: new Date().toISOString().split('T')[0], // æ—¥ä»˜ã¯å¸¸ã«ä»Šæ—¥
                            beforeTime: '', // æ™‚åˆ»ã¯ã‚¯ãƒªã‚¢
                            afterTime: '',  // æ™‚åˆ»ã¯ã‚¯ãƒªã‚¢
                            beforeOther: '', // å‚™è€ƒã¯ã‚¯ãƒªã‚¢
                            afterOther: ''   // å‚™è€ƒã¯ã‚¯ãƒªã‚¢
                        }));
                    }
                } catch (error) {
                    console.error("ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:", error);
                }
            };

            useEffect(() => {
                const unsubscribe = firebase.auth().onAuthStateChanged((user) => {
                    setUser(user);
                    setLoading(false);
                    if (user) {
                        loadRecords(user.uid);
                    }
                });
                return () => unsubscribe();
            }, []);

            const handleLogin = async () => {
                try {
                    const provider = new firebase.auth.GoogleAuthProvider();
                    await firebase.auth().signInWithPopup(provider);
                } catch (error) {
                    console.error("ãƒ­ã‚°ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼:", error);
                    alert("ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: " + error.message);
                }
            };

            const handleLogout = () => {
                firebase.auth().signOut();
            };

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                try {
                    if (editingId) {
                        // ç·¨é›†
                        await firebase.firestore()
                            .collection('records')
                            .doc(editingId)
                            .update(formData);
                        
                        const updatedRecords = records.map(record => 
                            record.id === editingId ? { ...formData, id: editingId, userId: user.uid } : record
                        );
                        setRecords(updatedRecords);
                        setEditingId(null);
                        alert('æ›´æ–°ã—ã¾ã—ãŸ');
                    } else {
                        // æ–°è¦è¿½åŠ 
                        const newRecord = {
                            ...formData,
                            userId: user.uid,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        };
                        
                        const docRef = await firebase.firestore()
                            .collection('records')
                            .add(newRecord);
                        
                        setRecords([{ ...newRecord, id: docRef.id }, ...records]);
                        alert('ä¿å­˜ã—ã¾ã—ãŸ');
                    }
                    
                    // å…¥åŠ›ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’Firestoreã«ä¿å­˜
                    await firebase.firestore()
                        .collection('userTemplates')
                        .doc(user.uid)
                        .set({
                            companyName: formData.companyName,
                            officeName: formData.officeName,
                            driverName: formData.driverName,
                            vehicleNumber: formData.vehicleNumber,
                            beforeMethod: formData.beforeMethod,
                            beforeExecutor: formData.beforeExecutor,
                            beforeAlcoholTest: formData.beforeAlcoholTest,
                            beforeAlcohol: formData.beforeAlcohol,
                            beforeHealth: formData.beforeHealth,
                            beforeInspection: formData.beforeInspection,
                            beforeWeather: formData.beforeWeather,
                            afterMethod: formData.afterMethod,
                            afterExecutor: formData.afterExecutor,
                            afterAlcoholTest: formData.afterAlcoholTest,
                            afterAlcohol: formData.afterAlcohol,
                            afterStatus: formData.afterStatus,
                            afterHandover: formData.afterHandover,
                            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                    
                    // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆæ—¥ä»˜ãƒ»æ™‚åˆ»ãƒ»å‚™è€ƒã®ã¿ã‚¯ãƒªã‚¢ã€ãã®ä»–ã¯ä¿æŒï¼‰
                    setFormData(prev => ({
                        ...prev,
                        date: new Date().toISOString().split('T')[0],
                        beforeTime: '',
                        beforeOther: '',
                        afterTime: '',
                        afterOther: ''
                    }));
                } catch (error) {
                    console.error("ä¿å­˜ã‚¨ãƒ©ãƒ¼:", error);
                    alert('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                }
            };

            const handleEdit = (record) => {
                setFormData(record);
                setEditingId(record.id);
                setActiveTab('input'); // è¨˜éŒ²å…¥åŠ›ã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆ
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const handleDelete = async (id) => {
                if (confirm('ã“ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã‹?')) {
                    try {
                        await firebase.firestore()
                            .collection('records')
                            .doc(id)
                            .delete();
                        
                        const updatedRecords = records.filter(record => record.id !== id);
                        setRecords(updatedRecords);
                        alert('å‰Šé™¤ã—ã¾ã—ãŸ');
                    } catch (error) {
                        console.error("å‰Šé™¤ã‚¨ãƒ©ãƒ¼:", error);
                        alert('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                    }
                }
            };

            const generatePDF = (month) => {
                const filteredRecords = records.filter(record => 
                    record.date.startsWith(month)
                ).sort((a, b) => a.date.localeCompare(b.date));

                if (filteredRecords.length === 0) {
                    alert('é¸æŠã—ãŸæœˆã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“');
                    return;
                }

                // å°åˆ·ç”¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ã
                const printWindow = window.open('', '_blank');
                
                // HTMLç”Ÿæˆ
                const html = `
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes">
    <title>ç‚¹å‘¼è¨˜éŒ²ç°¿ ${month.split('-')[0]}å¹´${month.split('-')[1]}æœˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            width: 100%;
            height: 100%;
        }
        
        body {
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', 'Meiryo', sans-serif;
            width: 100%;
            min-height: 100vh;
            padding: 15px;
            background: #f5f5f5;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            font-size: 24px;
            margin-bottom: 8px;
            color: #333;
        }
        
        .subtitle {
            text-align: center;
            font-size: 16px;
            margin-bottom: 20px;
            color: #666;
        }
        
        .no-print {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        
        .print-btn {
            background: #5a67d8;
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 8px;
            display: inline-block;
            min-width: 180px;
            touch-action: manipulation;
        }
        
        .print-btn:active {
            background: #4a57c8;
            transform: scale(0.98);
        }
        
        .print-btn.secondary {
            background: #6b7280;
        }
        
        .print-btn.secondary:active {
            background: #4b5563;
        }
        
        .instruction {
            color: #666;
            margin-top: 15px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            margin-top: 20px;
        }
        
        th, td {
            border: 1px solid #333;
            padding: 8px;
            text-align: left;
            vertical-align: top;
        }
        
        th {
            background-color: #5a67d8;
            color: white;
            font-weight: bold;
            text-align: center;
            font-size: 12px;
        }
        
        .date-col { width: 10%; }
        .name-col { width: 10%; }
        .vehicle-col { width: 12%; }
        .before-col { width: 17%; }
        .status-col { width: 17%; }
        .after-col { width: 17%; }
        
        /* ã‚¹ãƒãƒ›è¡¨ç¤ºæ™‚ */
        @media screen and (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            .subtitle {
                font-size: 14px;
            }
            
            .print-btn {
                display: block;
                width: 100%;
                max-width: 400px;
                margin: 10px auto;
                padding: 18px 20px;
                font-size: 16px;
            }
            
            table {
                font-size: 9px;
            }
            
            th {
                font-size: 10px;
                padding: 6px 4px;
            }
            
            td {
                padding: 6px 4px;
            }
        }
        
        /* è¶…å°å‹ã‚¹ãƒãƒ› */
        @media screen and (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 18px;
            }
            
            .subtitle {
                font-size: 13px;
            }
            
            table {
                font-size: 8px;
            }
            
            th {
                font-size: 9px;
                padding: 5px 3px;
            }
            
            td {
                padding: 5px 3px;
            }
        }
        
        /* å°åˆ·æ™‚ */
        @media print {
            @page {
                size: A4 landscape;
                margin: 10mm;
            }
            
            html, body {
                width: 100%;
                height: 100%;
                background: white;
            }
            
            body {
                padding: 0;
            }
            
            .container {
                max-width: none;
                padding: 0;
                box-shadow: none;
                border-radius: 0;
            }
            
            .no-print {
                display: none;
            }
            
            table {
                font-size: 10px;
            }
            
            th {
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ç‚¹å‘¼è¨˜éŒ²ç°¿</h1>
        <div class="subtitle">${month.split('-')[0]}å¹´${month.split('-')[1]}æœˆ</div>
        
        <div class="no-print">
            <button class="print-btn" onclick="window.print()">ğŸ“„ PDFã¨ã—ã¦ä¿å­˜</button>
            <button class="print-btn secondary" onclick="window.close()">âœ• é–‰ã˜ã‚‹</button>
            <p class="instruction">
                â€» ä¸Šã®ã€ŒPDFã¨ã—ã¦ä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã€<br>
                å°åˆ·ç”»é¢ã§ã€ŒPDFã¨ã—ã¦ä¿å­˜ã€ã‚’é¸æŠã—ã¦ãã ã•ã„
            </p>
        </div>
        
        <table>
            <thead>
                <tr>
                    <th class="date-col">æ—¥ä»˜</th>
                    <th class="name-col">é‹è»¢è€…å</th>
                    <th class="vehicle-col">è»Šä¸¡ç•ªå·</th>
                    <th class="before-col">æ¥­å‹™å‰ç‚¹å‘¼</th>
                    <th class="status-col">æ¥­å‹™å‰çŠ¶æ³</th>
                    <th class="after-col">æ¥­å‹™å¾Œç‚¹å‘¼</th>
                    <th class="status-col">æ¥­å‹™å¾ŒçŠ¶æ³</th>
                </tr>
            </thead>
            <tbody>
                ${filteredRecords.map(record => `
                    <tr>
                        <td>${record.date}</td>
                        <td>${record.driverName}</td>
                        <td>${record.vehicleNumber}</td>
                        <td>
                            æ™‚åˆ»: ${record.beforeTime}<br>
                            æ–¹æ³•: ${record.beforeMethod}<br>
                            åŸ·è¡Œè€…: ${record.beforeExecutor || '-'}
                        </td>
                        <td>
                            ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«æ¤œçŸ¥å™¨: ${record.beforeAlcoholTest}<br>
                            é…’æ°—å¸¯ã³: ${record.beforeAlcohol}<br>
                            å¥åº·çŠ¶æ…‹: ${record.beforeHealth}<br>
                            æ—¥å¸¸ç‚¹æ¤œ: ${record.beforeInspection}<br>
                            å¤©å€™: ${record.beforeWeather}
                            ${record.beforeOther ? '<br>å‚™è€ƒ: ' + record.beforeOther : ''}
                        </td>
                        <td>
                            æ™‚åˆ»: ${record.afterTime}<br>
                            æ–¹æ³•: ${record.afterMethod}<br>
                            åŸ·è¡Œè€…: ${record.afterExecutor || '-'}
                        </td>
                        <td>
                            ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«æ¤œçŸ¥å™¨: ${record.afterAlcoholTest}<br>
                            é…’æ°—å¸¯ã³: ${record.afterAlcohol}<br>
                            é‹è¡ŒçŠ¶æ³: ${record.afterStatus}<br>
                            äº¤æ›¿é€šå‘Š: ${record.afterHandover}
                            ${record.afterOther ? '<br>å‚™è€ƒ: ' + record.afterOther : ''}
                        </td>
                    </tr>
                `).join('')}
            </tbody>
        </table>
    </div>
</body>
</html>
                `;
                
                printWindow.document.write(html);
                printWindow.document.close();
            };

            // ä¸€æ‹¬ç™»éŒ²æ©Ÿèƒ½
            const handleBulkRegister = async () => {
                if (!bulkMonth) {
                    alert('å¹´æœˆã‚’é¸æŠã—ã¦ãã ã•ã„');
                    return;
                }

                if (!formData.companyName || !formData.driverName || !formData.vehicleNumber) {
                    alert('ä¼šç¤¾åã€é‹è»¢è€…åã€è»Šä¸¡ç•ªå·ã¯å¿…é ˆã§ã™');
                    return;
                }

                const confirmMsg = `${bulkMonth}ã®æœˆã®å…¨å–¶æ¥­æ—¥ã«è¨˜éŒ²ã‚’ä¸€æ‹¬ç™»éŒ²ã—ã¾ã™ã€‚\né™¤å¤–: ${excludeDays.map(d => ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'][d]).join(', ')}æ›œæ—¥\n${excludeDates.length > 0 ? 'é™¤å¤–æ—¥ä»˜: ' + excludeDates.join(', ') : ''}\n\nã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`;
                
                if (!confirm(confirmMsg)) {
                    return;
                }

                try {
                    const [year, month] = bulkMonth.split('-').map(Number);
                    const daysInMonth = new Date(year, month, 0).getDate();
                    const batch = firebase.firestore().batch();
                    let count = 0;

                    for (let day = 1; day <= daysInMonth; day++) {
                        const date = new Date(year, month - 1, day);
                        const dayOfWeek = date.getDay();
                        const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

                        // é™¤å¤–æ›œæ—¥ãƒã‚§ãƒƒã‚¯
                        if (excludeDays.includes(dayOfWeek)) {
                            continue;
                        }

                        // é™¤å¤–æ—¥ä»˜ãƒã‚§ãƒƒã‚¯
                        if (excludeDates.includes(dateStr)) {
                            continue;
                        }

                        // æ—¢å­˜ã®è¨˜éŒ²ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                        const existingRecord = records.find(r => r.date === dateStr);
                        if (existingRecord) {
                            continue; // æ—¢å­˜ã®è¨˜éŒ²ã¯ã‚¹ã‚­ãƒƒãƒ—
                        }

                        const newRecord = {
                            date: dateStr,
                            companyName: formData.companyName,
                            officeName: formData.officeName,
                            driverName: formData.driverName,
                            vehicleNumber: formData.vehicleNumber,
                            beforeTime: formData.beforeTime,
                            beforeMethod: formData.beforeMethod,
                            beforeExecutor: formData.beforeExecutor,
                            beforeAlcoholTest: formData.beforeAlcoholTest,
                            beforeAlcohol: formData.beforeAlcohol,
                            beforeHealth: formData.beforeHealth,
                            beforeInspection: formData.beforeInspection,
                            beforeWeather: formData.beforeWeather,
                            beforeOther: '',
                            afterTime: formData.afterTime,
                            afterMethod: formData.afterMethod,
                            afterExecutor: formData.afterExecutor,
                            afterAlcoholTest: formData.afterAlcoholTest,
                            afterAlcohol: formData.afterAlcohol,
                            afterStatus: formData.afterStatus,
                            afterHandover: formData.afterHandover,
                            afterOther: '',
                            userId: user.uid,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        };

                        const docRef = firebase.firestore().collection('records').doc();
                        batch.set(docRef, newRecord);
                        count++;
                    }

                    await batch.commit();
                    alert(`${count}ä»¶ã®è¨˜éŒ²ã‚’ä¸€æ‹¬ç™»éŒ²ã—ã¾ã—ãŸ`);
                    loadRecords(user.uid);
                    setActiveTab('list'); // è¨˜éŒ²ä¸€è¦§ã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆ
                } catch (error) {
                    console.error("ä¸€æ‹¬ç™»éŒ²ã‚¨ãƒ©ãƒ¼:", error);
                    alert('ä¸€æ‹¬ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                }
            };

            // æœˆå…¨ä½“ã®å‰Šé™¤æ©Ÿèƒ½
            const handleBulkDelete = async (month) => {
                const targetRecords = records.filter(record => record.date.startsWith(month));
                
                if (targetRecords.length === 0) {
                    alert('å‰Šé™¤ã™ã‚‹è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“');
                    return;
                }

                const confirmMsg = `${month}ã®è¨˜éŒ² ${targetRecords.length}ä»¶ ã‚’ã™ã¹ã¦å‰Šé™¤ã—ã¾ã™ã€‚\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚\n\næœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`;
                
                if (!confirm(confirmMsg)) {
                    return;
                }

                try {
                    const batch = firebase.firestore().batch();
                    
                    targetRecords.forEach(record => {
                        const docRef = firebase.firestore().collection('records').doc(record.id);
                        batch.delete(docRef);
                    });

                    await batch.commit();
                    alert(`${targetRecords.length}ä»¶ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`);
                    loadRecords(user.uid);
                    setActiveTab('list'); // è¨˜éŒ²ä¸€è¦§ã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆ
                } catch (error) {
                    console.error("ä¸€æ‹¬å‰Šé™¤ã‚¨ãƒ©ãƒ¼:", error);
                    alert('ä¸€æ‹¬å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                }
            };

            // é™¤å¤–æ›œæ—¥ã®ãƒˆã‚°ãƒ«
            const toggleExcludeDay = (day) => {
                if (excludeDays.includes(day)) {
                    setExcludeDays(excludeDays.filter(d => d !== day));
                } else {
                    setExcludeDays([...excludeDays, day]);
                }
            };

            // é™¤å¤–æ—¥ä»˜ã®ãƒˆã‚°ãƒ«
            const toggleExcludeDate = (date) => {
                if (excludeDates.includes(date)) {
                    setExcludeDates(excludeDates.filter(d => d !== date));
                } else {
                    setExcludeDates([...excludeDates, date]);
                }
            };

            // æŒ‡å®šæœˆã®æ—¥ä»˜ãƒªã‚¹ãƒˆç”Ÿæˆ
            const getMonthDates = (yearMonth) => {
                if (!yearMonth) return [];
                const [year, month] = yearMonth.split('-').map(Number);
                const daysInMonth = new Date(year, month, 0).getDate();
                const dates = [];
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(year, month - 1, day);
                    const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    dates.push({
                        date: dateStr,
                        dayOfWeek: ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'][date.getDay()],
                        dayNum: date.getDay()
                    });
                }
                return dates;
            };

            if (loading) {
                return (
                    <div className="container">
                        <div className="header">
                            <h1>ç‚¹å‘¼è¨˜éŒ²ç°¿</h1>
                        </div>
                        <div className="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
                    </div>
                );
            }

            if (!user) {
                return (
                    <div className="container">
                        <div className="header">
                            <h1>ç‚¹å‘¼è¨˜éŒ²ç°¿</h1>
                            <p>è»½è²¨ç‰©æ¥­è€…ã®é‹è»¢æ—¥å ±ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </p>
                        </div>
                        <div className="login-container">
                            <button className="login-btn" onClick={handleLogin}>
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                </svg>
                                Googleã§ãƒ­ã‚°ã‚¤ãƒ³
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="container">
                    <div className="header">
                        <h1>ç‚¹å‘¼è¨˜éŒ²ç°¿</h1>
                        <p>è»½è²¨ç‰©æ¥­è€…ã®é‹è»¢æ—¥å ±ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </p>
                    </div>

                    <div className="content">
                        <div className="user-info">
                            <div>
                                <div className="user-name">ğŸ‘¤ {user.displayName || user.email}</div>
                            </div>
                            <button className="logout-btn" onClick={handleLogout}>ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
                        </div>

                        {/* ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}
                        <div className="tabs">
                            <button 
                                className={`tab-button ${activeTab === 'input' ? 'active' : ''}`}
                                onClick={() => setActiveTab('input')}
                                type="button"
                            >
                                ğŸ“ è¨˜éŒ²å…¥åŠ›
                            </button>
                            <button 
                                className={`tab-button ${activeTab === 'bulk' ? 'active' : ''}`}
                                onClick={() => setActiveTab('bulk')}
                                type="button"
                            >
                                ğŸ“¦ ä¸€æ‹¬æ“ä½œ
                            </button>
                            <button 
                                className={`tab-button ${activeTab === 'list' ? 'active' : ''}`}
                                onClick={() => setActiveTab('list')}
                                type="button"
                            >
                                ğŸ“‹ è¨˜éŒ²ä¸€è¦§
                            </button>
                        </div>

                        {/* è¨˜éŒ²å…¥åŠ›ã‚¿ãƒ– */}
                        <div className={`tab-content ${activeTab === 'input' ? 'active' : ''}`}>
                        <form onSubmit={handleSubmit}>
                            <div className="form-section">
                                <h2>åŸºæœ¬æƒ…å ±</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>æ—¥ä»˜ *</label>
                                        <input type="date" name="date" value={formData.date} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>ä¼šç¤¾å</label>
                                        <input type="text" name="companyName" value={formData.companyName} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>å–¶æ¥­æ‰€å</label>
                                        <input type="text" name="officeName" value={formData.officeName} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>é‹è»¢è€…å *</label>
                                        <input type="text" name="driverName" value={formData.driverName} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>è»Šä¸¡ç•ªå· *</label>
                                        <input type="text" name="vehicleNumber" value={formData.vehicleNumber} onChange={handleInputChange} required />
                                    </div>
                                </div>
                            </div>

                            <div className="form-section">
                                <h2>æ¥­å‹™å‰ç‚¹å‘¼</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>å®Ÿæ–½æ—¥æ™‚ *</label>
                                        <input type="time" name="beforeTime" value={formData.beforeTime} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>ç‚¹å‘¼æ–¹æ³•</label>
                                        <select name="beforeMethod" value={formData.beforeMethod} onChange={handleInputChange}>
                                            <option>å¯¾é¢</option>
                                            <option>é›»è©±</option>
                                            <option>ãã®ä»–</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ç‚¹å‘¼åŸ·è¡Œè€…</label>
                                        <input type="text" name="beforeExecutor" value={formData.beforeExecutor} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«æ¤œçŸ¥å™¨ä½¿ç”¨</label>
                                        <select name="beforeAlcoholTest" value={formData.beforeAlcoholTest} onChange={handleInputChange}>
                                            <option>æœ‰</option>
                                            <option>ç„¡</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>é…’æ°—å¸¯ã³</label>
                                        <select name="beforeAlcohol" value={formData.beforeAlcohol} onChange={handleInputChange}>
                                            <option>ç„¡</option>
                                            <option>æœ‰</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>å¥åº·çŠ¶æ…‹</label>
                                        <select name="beforeHealth" value={formData.beforeHealth} onChange={handleInputChange}>
                                            <option>è‰¯å¥½</option>
                                            <option>ç–²åŠ´ã‚ã‚Š</option>
                                            <option>ç¡çœ ä¸è¶³</option>
                                            <option>ä½“èª¿ä¸è‰¯</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>æ—¥å¸¸ç‚¹æ¤œ</label>
                                        <select name="beforeInspection" value={formData.beforeInspection} onChange={handleInputChange}>
                                            <option>è‰¯å¥½</option>
                                            <option>è¦æ³¨æ„</option>
                                            <option>è¦ä¿®ç†</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>å¤©å€™</label>
                                        <select name="beforeWeather" value={formData.beforeWeather} onChange={handleInputChange}>
                                            <option>æ™´</option>
                                            <option>æ›‡</option>
                                            <option>é›¨</option>
                                            <option>é›ª</option>
                                        </select>
                                    </div>
                                    <div className="form-group" style={{gridColumn: '1 / -1'}}>
                                        <label>ãã®ä»–æŒ‡ç¤ºäº‹é …</label>
                                        <textarea name="beforeOther" value={formData.beforeOther} onChange={handleInputChange} rows="2"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div className="form-section">
                                <h2>æ¥­å‹™å¾Œç‚¹å‘¼</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>å®Ÿæ–½æ—¥æ™‚ *</label>
                                        <input type="time" name="afterTime" value={formData.afterTime} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>ç‚¹å‘¼æ–¹æ³•</label>
                                        <select name="afterMethod" value={formData.afterMethod} onChange={handleInputChange}>
                                            <option>å¯¾é¢</option>
                                            <option>é›»è©±</option>
                                            <option>ãã®ä»–</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ç‚¹å‘¼åŸ·è¡Œè€…</label>
                                        <input type="text" name="afterExecutor" value={formData.afterExecutor} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«æ¤œçŸ¥å™¨ä½¿ç”¨</label>
                                        <select name="afterAlcoholTest" value={formData.afterAlcoholTest} onChange={handleInputChange}>
                                            <option>æœ‰</option>
                                            <option>ç„¡</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>é…’æ°—å¸¯ã³</label>
                                        <select name="afterAlcohol" value={formData.afterAlcohol} onChange={handleInputChange}>
                                            <option>ç„¡</option>
                                            <option>æœ‰</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>é‹è¡ŒçŠ¶æ³</label>
                                        <select name="afterStatus" value={formData.afterStatus} onChange={handleInputChange}>
                                            <option>ç•°å¸¸ãªã—</option>
                                            <option>é…å»¶ã‚ã‚Š</option>
                                            <option>äº‹æ•…ã‚ã‚Š</option>
                                            <option>é•åã‚ã‚Š</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>äº¤æ›¿é‹è»¢è€…ã¸ã®é€šå‘Š</label>
                                        <select name="afterHandover" value={formData.afterHandover} onChange={handleInputChange}>
                                            <option>ãªã—</option>
                                            <option>ã‚ã‚Š</option>
                                        </select>
                                    </div>
                                    <div className="form-group" style={{gridColumn: '1 / -1'}}>
                                        <label>ãã®ä»–æŒ‡ç¤ºäº‹é …</label>
                                        <textarea name="afterOther" value={formData.afterOther} onChange={handleInputChange} rows="2"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div className="btn-group">
                                <button type="submit" className="btn btn-primary">
                                    {editingId ? 'æ›´æ–°ã™ã‚‹' : 'è¨˜éŒ²ã‚’ä¿å­˜'}
                                </button>
                                {editingId && (
                                    <button type="button" className="btn btn-secondary" onClick={() => {
                                        setEditingId(null);
                                        const initialFormData = {
                                            date: new Date().toISOString().split('T')[0],
                                            companyName: '',
                                            officeName: '',
                                            driverName: '',
                                            vehicleNumber: '',
                                            beforeTime: '',
                                            beforeMethod: 'å¯¾é¢',
                                            beforeExecutor: '',
                                            beforeAlcoholTest: 'æœ‰',
                                            beforeAlcohol: 'ç„¡',
                                            beforeHealth: 'è‰¯å¥½',
                                            beforeInspection: 'è‰¯å¥½',
                                            beforeWeather: 'æ™´',
                                            beforeOther: '',
                                            afterTime: '',
                                            afterMethod: 'å¯¾é¢',
                                            afterExecutor: '',
                                            afterAlcoholTest: 'æœ‰',
                                            afterAlcohol: 'ç„¡',
                                            afterStatus: 'ç•°å¸¸ãªã—',
                                            afterHandover: 'ãªã—',
                                            afterOther: ''
                                        };
                                        setFormData(initialFormData);
                                    }}>
                                        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                                    </button>
                                )}
                            </div>
                        </form>
                        </div>

                        {/* ä¸€æ‹¬æ“ä½œã‚¿ãƒ– */}
                        <div className={`tab-content ${activeTab === 'bulk' ? 'active' : ''}`}>
                            <div className="form-section">
                                <h2>ä¸€æ‹¬æ“ä½œ</h2>
                                
                                {/* ä¸€æ‹¬ç™»éŒ² */}
                                <div style={{marginBottom: '30px', padding: '20px', background: '#f7fafc', borderRadius: '10px'}}>
                                    <h3 style={{fontSize: '18px', marginBottom: '15px', color: '#2d3748'}}>ğŸ“ æœˆé–“ä¸€æ‹¬ç™»éŒ²</h3>
                                    <p style={{fontSize: '14px', color: '#718096', marginBottom: '15px'}}>
                                        æŒ‡å®šã—ãŸæœˆã®å…¨å–¶æ¥­æ—¥ã«åŒã˜å†…å®¹ã®è¨˜éŒ²ã‚’ä¸€æ‹¬ç™»éŒ²ã—ã¾ã™
                                    </p>
                                    
                                    <div className="form-group" style={{marginBottom: '15px'}}>
                                        <label>å¯¾è±¡å¹´æœˆ</label>
                                        <input 
                                            type="month" 
                                            value={bulkMonth}
                                            onChange={(e) => setBulkMonth(e.target.value)}
                                            style={{maxWidth: '200px'}}
                                        />
                                    </div>

                                    <div className="form-group" style={{marginBottom: '15px'}}>
                                        <label>é™¤å¤–ã™ã‚‹æ›œæ—¥</label>
                                        <div style={{display: 'flex', gap: '10px', flexWrap: 'wrap'}}>
                                            {['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'].map((day, index) => (
                                                <label key={index} style={{display: 'flex', alignItems: 'center', gap: '5px', cursor: 'pointer'}}>
                                                    <input 
                                                        type="checkbox"
                                                        checked={excludeDays.includes(index)}
                                                        onChange={() => toggleExcludeDay(index)}
                                                    />
                                                    <span>{day}æ›œæ—¥</span>
                                                </label>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="form-group" style={{marginBottom: '15px'}}>
                                        <label>é™¤å¤–ã™ã‚‹æ—¥ä»˜ã‚’é¸æŠ</label>
                                        <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(120px, 1fr))', gap: '8px', maxHeight: '200px', overflow: 'auto', padding: '10px', background: 'white', borderRadius: '8px', border: '1px solid #e2e8f0'}}>
                                            {getMonthDates(bulkMonth).map(({date, dayOfWeek, dayNum}) => (
                                                <label key={date} style={{
                                                    display: 'flex', 
                                                    alignItems: 'center', 
                                                    gap: '5px', 
                                                    cursor: 'pointer',
                                                    padding: '5px',
                                                    borderRadius: '4px',
                                                    background: excludeDays.includes(dayNum) ? '#f0f0f0' : 'white',
                                                    opacity: excludeDays.includes(dayNum) ? 0.5 : 1
                                                }}>
                                                    <input 
                                                        type="checkbox"
                                                        checked={excludeDates.includes(date)}
                                                        onChange={() => toggleExcludeDate(date)}
                                                        disabled={excludeDays.includes(dayNum)}
                                                    />
                                                    <span style={{fontSize: '12px'}}>{date.split('-')[2]}æ—¥({dayOfWeek})</span>
                                                </label>
                                            ))}
                                        </div>
                                        <p style={{fontSize: '12px', color: '#718096', marginTop: '5px'}}>
                                            â€»é™¤å¤–æ›œæ—¥ã«è©²å½“ã™ã‚‹æ—¥ã¯ã‚°ãƒ¬ãƒ¼è¡¨ç¤ºã•ã‚Œã¾ã™
                                        </p>
                                    </div>

                                    <div style={{background: '#fff5e6', padding: '15px', borderRadius: '8px', marginBottom: '15px'}}>
                                        <p style={{fontSize: '14px', color: '#744210', marginBottom: '8px'}}>
                                            <strong>âš ï¸ æ³¨æ„äº‹é …:</strong>
                                        </p>
                                        <ul style={{fontSize: '13px', color: '#744210', paddingLeft: '20px', margin: 0}}>
                                            <li>ä¸Šè¨˜ãƒ•ã‚©ãƒ¼ãƒ ã§å…¥åŠ›ã—ãŸåŸºæœ¬æƒ…å ±ãƒ»æ¥­å‹™å‰ãƒ»æ¥­å‹™å¾Œã®è¨­å®šãŒä½¿ç”¨ã•ã‚Œã¾ã™</li>
                                            <li>æ™‚åˆ»ã‚„å‚™è€ƒã¯ç©ºæ¬„ã§ç™»éŒ²ã•ã‚Œã¾ã™ï¼ˆå¾Œã§å€‹åˆ¥ã«ç·¨é›†ã—ã¦ãã ã•ã„ï¼‰</li>
                                            <li>æ—¢ã«è¨˜éŒ²ãŒå­˜åœ¨ã™ã‚‹æ—¥ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™</li>
                                        </ul>
                                    </div>

                                    <button 
                                        type="button"
                                        className="btn btn-primary"
                                        onClick={handleBulkRegister}
                                        style={{width: '100%', maxWidth: '300px'}}
                                    >
                                        ä¸€æ‹¬ç™»éŒ²ã‚’å®Ÿè¡Œ
                                    </button>
                                </div>

                                {/* ä¸€æ‹¬å‰Šé™¤ */}
                                <div style={{padding: '20px', background: '#fff5f5', borderRadius: '10px', border: '2px solid #fc8181'}}>
                                    <h3 style={{fontSize: '18px', marginBottom: '15px', color: '#c53030'}}>ğŸ—‘ï¸ æœˆé–“ä¸€æ‹¬å‰Šé™¤</h3>
                                    <p style={{fontSize: '14px', color: '#744210', marginBottom: '15px'}}>
                                        æŒ‡å®šã—ãŸæœˆã®è¨˜éŒ²ã‚’ã™ã¹ã¦å‰Šé™¤ã—ã¾ã™ã€‚ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚
                                    </p>
                                    
                                    <div className="month-selector" style={{marginBottom: '15px'}}>
                                        <label>å‰Šé™¤å¯¾è±¡æœˆ:</label>
                                        <select id="bulkDeleteMonth" defaultValue={new Date().toISOString().slice(0, 7)}>
                                            {Array.from({length: 12}, (_, i) => {
                                                const d = new Date();
                                                d.setMonth(d.getMonth() - i);
                                                const monthStr = d.toISOString().slice(0, 7);
                                                const count = records.filter(r => r.date.startsWith(monthStr)).length;
                                                return <option key={monthStr} value={monthStr}>{monthStr} ({count}ä»¶)</option>;
                                            })}
                                        </select>
                                        <button 
                                            type="button"
                                            className="btn btn-delete" 
                                            onClick={() => {
                                                const month = document.getElementById('bulkDeleteMonth').value;
                                                handleBulkDelete(month);
                                            }}
                                        >
                                            ã“ã®æœˆã®è¨˜éŒ²ã‚’ã™ã¹ã¦å‰Šé™¤
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* è¨˜éŒ²ä¸€è¦§ã‚¿ãƒ– */}
                        <div className={`tab-content ${activeTab === 'list' ? 'active' : ''}`}>
                            <div className="records-list">
                                <h2 style={{marginBottom: '20px', color: '#2d3748'}}>è¨˜éŒ²ä¸€è¦§</h2>
                                
                                <div className="month-selector">
                                    <label style={{fontWeight: '600'}}>æœˆåˆ¥PDFå‡ºåŠ›:</label>
                                    <select id="monthSelect" defaultValue={new Date().toISOString().slice(0, 7)}>
                                        {Array.from({length: 12}, (_, i) => {
                                            const d = new Date();
                                            d.setMonth(d.getMonth() - i);
                                            const monthStr = d.toISOString().slice(0, 7);
                                            return <option key={monthStr} value={monthStr}>{monthStr}</option>;
                                        })}
                                    </select>
                                    <button className="btn btn-tertiary" onClick={() => {
                                        const month = document.getElementById('monthSelect').value;
                                        generatePDF(month);
                                    }}>
                                        PDFå‡ºåŠ›
                                    </button>
                                </div>

                            {records.map(record => (
                                <div key={record.id} className="record-item">
                                    <div className="record-header">
                                        <div className="record-date">
                                            ğŸ“… {record.date} - {record.driverName} ({record.vehicleNumber})
                                        </div>
                                        <div className="record-actions">
                                            <button className="btn-small btn-edit" onClick={() => handleEdit(record)}>ç·¨é›†</button>
                                            <button className="btn-small btn-delete" onClick={() => handleDelete(record.id)}>å‰Šé™¤</button>
                                        </div>
                                    </div>
                                    <div className="record-details">
                                        <strong>æ¥­å‹™å‰:</strong> {record.beforeTime} ({record.beforeMethod}) - å¥åº·: {record.beforeHealth}<br/>
                                        <strong>æ¥­å‹™å¾Œ:</strong> {record.afterTime} ({record.afterMethod}) - çŠ¶æ³: {record.afterStatus}
                                    </div>
                                </div>
                            ))}
                            
                            {records.length === 0 && (
                                <div style={{textAlign: 'center', padding: '40px', color: '#a0aec0'}}>
                                    ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“
                                </div>
                            )}
                        </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
