<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁÇπÂëºË®òÈå≤Á∞ø - „ÉÄ„Éº„ÇØ„É¢„Éº„Éâ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            background: linear-gradient(45deg, #0f1419 0%, #1a1f2a 25%, #2d3748 50%, #1a202c 75%, #0f1419 100%);
            background-size: 400% 400%;
            animation: gradientMove 16s ease infinite;
            min-height: 100vh;
            padding: 20px;
            color: #e6ecef;
        }

        @keyframes gradientMove {
            0% {
                background-position: 0% 50%;
            }
            25% {
                background-position: 50% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            75% {
                background-position: 50% 100%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #1a1f2a;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 0 1px rgba(230,236,239,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: #e6ecef;
            padding: 30px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #e6ecef;
        }

        .header p {
            color: #cbd5e0;
        }

        .login-container {
            padding: 60px 30px;
            text-align: center;
        }

        .login-btn {
            background: #4a5b7c;
            color: #e6ecef;
            border: 2px solid #5a6d8f;
            padding: 15px 40px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .login-btn:hover {
            background: #5a6d8f;
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(74,91,124,0.4);
        }

        .content {
            padding: 30px;
        }

        .user-info {
            background: #2d3748;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .user-name {
            font-weight: 600;
            color: #e6ecef;
        }

        .logout-btn {
            background: #e53e3e;
            color: #ffffff;
            border: none;
            padding: 10px 25px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .logout-btn:hover {
            background: #c53030;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(197,48,48,0.4);
        }

        .form-section {
            background: #2d3748;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .form-section h2 {
            color: #e6ecef;
            font-size: 20px;
            margin-bottom: 20px;
            border-bottom: 3px solid #4a5b7c;
            padding-bottom: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: #cbd5e0;
            margin-bottom: 8px;
            font-size: 14px;
        }

        input, select, textarea {
            padding: 12px;
            border: 2px solid #4a5b7c;
            border-radius: 12px;
            font-size: 14px;
            transition: all 0.3s;
            font-family: 'Roboto', Arial, sans-serif;
            background: #1a1f2a;
            color: #e6ecef;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #5a6d8f;
            box-shadow: 0 0 0 3px rgba(90, 109, 143, 0.3), inset 0 2px 4px rgba(0,0,0,0.3);
        }

        input::placeholder, textarea::placeholder {
            color: #718096;
        }

        select option {
            background: #1a1f2a;
            color: #e6ecef;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 150px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, #4a5b7c 0%, #5a6d8f 100%);
            color: #e6ecef;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5a6d8f 0%, #6a7d9f 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(74,91,124,0.4);
        }

        .btn-secondary {
            background: #38a169;
            color: #ffffff;
        }

        .btn-secondary:hover {
            background: #2f855a;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(56,161,105,0.4);
        }

        .btn-tertiary {
            background: #dd6b20;
            color: #ffffff;
        }

        .btn-tertiary:hover {
            background: #c05621;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(221,107,32,0.4);
        }

        .records-list {
            margin-top: 30px;
        }

        .record-item {
            background: #2d3748;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 5px solid #4a5b7c;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .record-item:hover {
            background: #374151;
            box-shadow: 0 6px 12px rgba(0,0,0,0.4);
            transform: translateY(-2px);
        }

        .record-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .record-date {
            font-weight: 700;
            color: #e6ecef;
            font-size: 16px;
        }

        .record-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 15px;
            font-size: 13px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .btn-edit {
            background: #3182ce;
            color: #ffffff;
        }

        .btn-edit:hover {
            background: #2c5282;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(49,130,206,0.4);
        }

        .btn-delete {
            background: #e53e3e;
            color: #ffffff;
        }

        .btn-delete:hover {
            background: #c53030;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(229,62,62,0.4);
        }

        .record-details {
            color: #cbd5e0;
            font-size: 14px;
            line-height: 1.6;
        }

        .month-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .month-selector label {
            color: #e6ecef;
        }

        .month-selector select {
            flex: 1;
            min-width: 150px;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .content {
                padding: 20px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                font-size: 15px;
            }

            .record-item {
                padding: 15px;
            }

            .tab-button {
                font-size: 13px;
                padding: 12px 15px;
            }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #cbd5e0;
        }

        .tabs {
            display: flex;
            gap: 0;
            margin-bottom: 30px;
            border-bottom: 3px solid #2d3748;
        }

        .tab-button {
            padding: 15px 30px;
            background: transparent;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            color: #cbd5e0;
            border-bottom: 3px solid transparent;
            margin-bottom: -3px;
            transition: all 0.3s;
            white-space: nowrap;
            flex: 1;
            box-shadow: none;
        }

        .tab-button:hover {
            color: #e6ecef;
            background: rgba(74, 91, 124, 0.3);
        }

        .tab-button.active {
            color: #ffffff;
            border-bottom-color: transparent;
        }

        .tab-button.active:nth-child(1) {
            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .tab-button.active:nth-child(2) {
            background: linear-gradient(135deg, #dd6b20 0%, #c05621 100%);
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .tab-button.active:nth-child(3) {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .tabs {
                border-bottom: 2px solid #2d3748;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .tab-button {
                padding: 12px 15px;
                font-size: 14px;
                border-bottom: 2px solid transparent;
                margin-bottom: -2px;
                flex: 0 0 auto;
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // FirebaseË®≠ÂÆö
        const firebaseConfig = {
            apiKey: "AIzaSyDjAfZXyrzQlHIT8qpj0vynIznrJDFcUe4",
            authDomain: "tenko-kiroku.firebaseapp.com",
            projectId: "tenko-kiroku",
            storageBucket: "tenko-kiroku.firebasestorage.app",
            messagingSenderId: "67100796956",
            appId: "1:67100796956:web:c57a2f0449e0a766a217d9",
            measurementId: "G-CDJNEZ5LWX"
        };

        // FirebaseÂàùÊúüÂåñ
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }

        function App() {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [records, setRecords] = useState([]);
            const [editingId, setEditingId] = useState(null);
            const [activeTab, setActiveTab] = useState('input'); // 'input', 'bulk', 'list'
            
            // ‰∏ÄÊã¨Êìç‰ΩúÁî®„ÅÆstate
            const [bulkMonth, setBulkMonth] = useState(new Date().toISOString().slice(0, 7));
            const [excludeDays, setExcludeDays] = useState([0]); // 0=Êó•ÊõúÊó•
            const [excludeDates, setExcludeDates] = useState([]);
            
            // „Éï„Ç©„Éº„É†„ÅÆÁä∂ÊÖã
            const [formData, setFormData] = useState({
                date: new Date().toISOString().split('T')[0],
                companyName: '',
                officeName: '',
                driverName: '',
                vehicleNumber: '',
                // Ê•≠ÂãôÂâçÁÇπÂëº
                beforeTime: '',
                beforeMethod: 'ÂØæÈù¢',
                beforeExecutor: '',
                beforeAlcoholTest: 'Êúâ',
                beforeAlcohol: 'ÁÑ°',
                beforeHealth: 'ËâØÂ•Ω',
                beforeInspection: 'ËâØÂ•Ω',
                beforeWeather: 'Êô¥',
                beforeOther: '',
                // Ê•≠ÂãôÂæåÁÇπÂëº
                afterTime: '',
                afterMethod: 'ÂØæÈù¢',
                afterExecutor: '',
                afterAlcoholTest: 'Êúâ',
                afterAlcohol: 'ÁÑ°',
                afterStatus: 'Áï∞Â∏∏„Å™„Åó',
                afterHandover: '„Å™„Åó',
                afterOther: ''
            });

            // Firestore„Åã„Çâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„ÇÄ
            const loadRecords = async (userId) => {
                try {
                    const snapshot = await firebase.firestore()
                        .collection('records')
                        .where('userId', '==', userId)
                        .orderBy('date', 'desc')
                        .get();
                    
                    const loadedRecords = [];
                    snapshot.forEach(doc => {
                        loadedRecords.push({ id: doc.id, ...doc.data() });
                    });
                    setRecords(loadedRecords);

                    // ÂÖ•Âäõ„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíË™≠„ÅøËæº„ÇÄ
                    const templateDoc = await firebase.firestore()
                        .collection('userTemplates')
                        .doc(userId)
                        .get();
                    
                    if (templateDoc.exists) {
                        const template = templateDoc.data();
                        setFormData(prev => ({
                            ...template,
                            date: new Date().toISOString().split('T')[0], // Êó•‰ªò„ÅØÂ∏∏„Å´‰ªäÊó•
                            beforeTime: '', // ÊôÇÂàª„ÅØ„ÇØ„É™„Ç¢
                            afterTime: '',  // ÊôÇÂàª„ÅØ„ÇØ„É™„Ç¢
                            beforeOther: '', // ÂÇôËÄÉ„ÅØ„ÇØ„É™„Ç¢
                            afterOther: ''   // ÂÇôËÄÉ„ÅØ„ÇØ„É™„Ç¢
                        }));
                    }
                } catch (error) {
                    console.error("„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„Ç®„É©„Éº:", error);
                }
            };

            useEffect(() => {
                const unsubscribe = firebase.auth().onAuthStateChanged((user) => {
                    setUser(user);
                    setLoading(false);
                    if (user) {
                        loadRecords(user.uid);
                    }
                });
                return () => unsubscribe();
            }, []);

            const handleLogin = async () => {
                try {
                    const provider = new firebase.auth.GoogleAuthProvider();
                    await firebase.auth().signInWithPopup(provider);
                } catch (error) {
                    console.error("„É≠„Ç∞„Ç§„É≥„Ç®„É©„Éº:", error);
                    alert("„É≠„Ç∞„Ç§„É≥„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: " + error.message);
                }
            };

            const handleLogout = () => {
                firebase.auth().signOut();
            };

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                try {
                    if (editingId) {
                        // Á∑®ÈõÜ
                        await firebase.firestore()
                            .collection('records')
                            .doc(editingId)
                            .update(formData);
                        
                        const updatedRecords = records.map(record => 
                            record.id === editingId ? { ...formData, id: editingId, userId: user.uid } : record
                        );
                        setRecords(updatedRecords);
                        setEditingId(null);
                        alert('Êõ¥Êñ∞„Åó„Åæ„Åó„Åü');
                    } else {
                        // Êñ∞Ë¶èËøΩÂä†
                        const newRecord = {
                            ...formData,
                            userId: user.uid,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        };
                        
                        const docRef = await firebase.firestore()
                            .collection('records')
                            .add(newRecord);
                        
                        setRecords([{ ...newRecord, id: docRef.id }, ...records]);
                        alert('‰øùÂ≠ò„Åó„Åæ„Åó„Åü');
                    }
                    
                    // ÂÖ•Âäõ„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíFirestore„Å´‰øùÂ≠ò
                    await firebase.firestore()
                        .collection('userTemplates')
                        .doc(user.uid)
                        .set({
                            companyName: formData.companyName,
                            officeName: formData.officeName,
                            driverName: formData.driverName,
                            vehicleNumber: formData.vehicleNumber,
                            beforeMethod: formData.beforeMethod,
                            beforeExecutor: formData.beforeExecutor,
                            beforeAlcoholTest: formData.beforeAlcoholTest,
                            beforeAlcohol: formData.beforeAlcohol,
                            beforeHealth: formData.beforeHealth,
                            beforeInspection: formData.beforeInspection,
                            beforeWeather: formData.beforeWeather,
                            afterMethod: formData.afterMethod,
                            afterExecutor: formData.afterExecutor,
                            afterAlcoholTest: formData.afterAlcoholTest,
                            afterAlcohol: formData.afterAlcohol,
                            afterStatus: formData.afterStatus,
                            afterHandover: formData.afterHandover,
                            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                    
                    // „Éï„Ç©„Éº„É†„Çí„É™„Çª„ÉÉ„ÉàÔºàÊó•‰ªò„ÉªÊôÇÂàª„ÉªÂÇôËÄÉ„ÅÆ„Åø„ÇØ„É™„Ç¢„ÄÅ„Åù„ÅÆ‰ªñ„ÅØ‰øùÊåÅÔºâ
                    setFormData(prev => ({
                        ...prev,
                        date: new Date().toISOString().split('T')[0],
                        beforeTime: '',
                        beforeOther: '',
                        afterTime: '',
                        afterOther: ''
                    }));
                } catch (error) {
                    console.error("‰øùÂ≠ò„Ç®„É©„Éº:", error);
                    alert('‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
                }
            };

            const handleEdit = (record) => {
                setFormData(record);
                setEditingId(record.id);
                setActiveTab('input'); // Ë®òÈå≤ÂÖ•Âäõ„Çø„Éñ„Å´Âàá„ÇäÊõø„Åà
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const handleDelete = async (id) => {
                if (confirm('„Åì„ÅÆË®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åô„Åã?')) {
                    try {
                        await firebase.firestore()
                            .collection('records')
                            .doc(id)
                            .delete();
                        
                        const updatedRecords = records.filter(record => record.id !== id);
                        setRecords(updatedRecords);
                        alert('ÂâäÈô§„Åó„Åæ„Åó„Åü');
                    } catch (error) {
                        console.error("ÂâäÈô§„Ç®„É©„Éº:", error);
                        alert('ÂâäÈô§„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
                    }
                }
            };

            const generatePDF = (month) => {
                const filteredRecords = records.filter(record => 
                    record.date.startsWith(month)
                ).sort((a, b) => a.date.localeCompare(b.date));

                if (filteredRecords.length === 0) {
                    alert('ÈÅ∏Êäû„Åó„ÅüÊúà„ÅÆ„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                    return;
                }

                // Âç∞Âà∑Áî®„ÅÆ„Ç¶„Ç£„É≥„Éâ„Ç¶„ÇíÈñã„Åè
                const printWindow = window.open('', '_blank');
                
                // HTMLÁîüÊàê
                const html = `
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes">
    <title>ÁÇπÂëºË®òÈå≤Á∞ø ${month.split('-')[0]}Âπ¥${month.split('-')[1]}Êúà</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            width: 100%;
            height: 100%;
        }
        
        body {
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', 'Meiryo', sans-serif;
            width: 100%;
            min-height: 100vh;
            padding: 15px;
            background: #f5f5f5;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            font-size: 24px;
            margin-bottom: 8px;
            color: #333;
        }
        
        .subtitle {
            text-align: center;
            font-size: 16px;
            margin-bottom: 20px;
            color: #666;
        }
        
        .no-print {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        
        .print-btn {
            background: #5a67d8;
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 8px;
            display: inline-block;
            min-width: 180px;
            touch-action: manipulation;
        }
        
        .print-btn:active {
            background: #4a57c8;
            transform: scale(0.98);
        }
        
        .print-btn.secondary {
            background: #6b7280;
        }
        
        .print-btn.secondary:active {
            background: #4b5563;
        }
        
        .instruction {
            color: #666;
            margin-top: 15px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            margin-top: 20px;
        }
        
        th, td {
            border: 1px solid #333;
            padding: 8px;
            text-align: left;
            vertical-align: top;
        }
        
        th {
            background-color: #5a67d8;
            color: white;
            font-weight: bold;
            text-align: center;
            font-size: 12px;
        }
        
        .date-col { width: 10%; }
        .name-col { width: 10%; }
        .vehicle-col { width: 12%; }
        .before-col { width: 17%; }
        .status-col { width: 17%; }
        .after-col { width: 17%; }
        
        /* „Çπ„Éû„ÉõË°®Á§∫ÊôÇ */
        @media screen and (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            .subtitle {
                font-size: 14px;
            }
            
            .print-btn {
                display: block;
                width: 100%;
                max-width: 400px;
                margin: 10px auto;
                padding: 18px 20px;
                font-size: 16px;
            }
            
            table {
                font-size: 9px;
            }
            
            th {
                font-size: 10px;
                padding: 6px 4px;
            }
            
            td {
                padding: 6px 4px;
            }
        }
        
        /* Ë∂ÖÂ∞èÂûã„Çπ„Éû„Éõ */
        @media screen and (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 18px;
            }
            
            .subtitle {
                font-size: 13px;
            }
            
            table {
                font-size: 8px;
            }
            
            th {
                font-size: 9px;
                padding: 5px 3px;
            }
            
            td {
                padding: 5px 3px;
            }
        }
        
        /* Âç∞Âà∑ÊôÇ */
        @media print {
            @page {
                size: A4 landscape;
                margin: 10mm;
            }
            
            html, body {
                width: 100%;
                height: 100%;
                background: white;
            }
            
            body {
                padding: 0;
            }
            
            .container {
                max-width: none;
                padding: 0;
                box-shadow: none;
                border-radius: 0;
            }
            
            .no-print {
                display: none;
            }
            
            table {
                font-size: 10px;
            }
            
            th {
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ÁÇπÂëºË®òÈå≤Á∞ø</h1>
        <div class="subtitle">${month.split('-')[0]}Âπ¥${month.split('-')[1]}Êúà</div>
        
        <div class="no-print">
            <button class="print-btn" onclick="window.print()">üìÑ PDF„Å®„Åó„Å¶‰øùÂ≠ò</button>
            <button class="print-btn secondary" onclick="window.close()">‚úï Èñâ„Åò„Çã</button>
            <p class="instruction">
                ‚Äª ‰∏ä„ÅÆ„ÄåPDF„Å®„Åó„Å¶‰øùÂ≠ò„Äç„Éú„Çø„É≥„Çí„Çø„ÉÉ„Éó„Åó„ÄÅ<br>
                Âç∞Âà∑ÁîªÈù¢„Åß„ÄåPDF„Å®„Åó„Å¶‰øùÂ≠ò„Äç„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ
            </p>
        </div>
        
        <table>
            <thead>
                <tr>
                    <th class="date-col">Êó•‰ªò</th>
                    <th class="name-col">ÈÅãËª¢ËÄÖÂêç</th>
                    <th class="vehicle-col">Ëªä‰∏°Áï™Âè∑</th>
                    <th class="before-col">Ê•≠ÂãôÂâçÁÇπÂëº</th>
                    <th class="status-col">Ê•≠ÂãôÂâçÁä∂Ê≥Å</th>
                    <th class="after-col">Ê•≠ÂãôÂæåÁÇπÂëº</th>
                    <th class="status-col">Ê•≠ÂãôÂæåÁä∂Ê≥Å</th>
                </tr>
            </thead>
            <tbody>
                ${filteredRecords.map(record => `
                    <tr>
                        <td>${record.date}</td>
                        <td>${record.driverName}</td>
                        <td>${record.vehicleNumber}</td>
                        <td>
                            ÊôÇÂàª: ${record.beforeTime}<br>
                            ÊñπÊ≥ï: ${record.beforeMethod}<br>
                            Âü∑Ë°åËÄÖ: ${record.beforeExecutor || '-'}
                        </td>
                        <td>
                            „Ç¢„É´„Ç≥„Éº„É´Ê§úÁü•Âô®: ${record.beforeAlcoholTest}<br>
                            ÈÖíÊ∞óÂ∏Ø„Å≥: ${record.beforeAlcohol}<br>
                            ÂÅ•Â∫∑Áä∂ÊÖã: ${record.beforeHealth}<br>
                            Êó•Â∏∏ÁÇπÊ§ú: ${record.beforeInspection}<br>
                            Â§©ÂÄô: ${record.beforeWeather}
                            ${record.beforeOther ? '<br>ÂÇôËÄÉ: ' + record.beforeOther : ''}
                        </td>
                        <td>
                            ÊôÇÂàª: ${record.afterTime}<br>
                            ÊñπÊ≥ï: ${record.afterMethod}<br>
                            Âü∑Ë°åËÄÖ: ${record.afterExecutor || '-'}
                        </td>
                        <td>
                            „Ç¢„É´„Ç≥„Éº„É´Ê§úÁü•Âô®: ${record.afterAlcoholTest}<br>
                            ÈÖíÊ∞óÂ∏Ø„Å≥: ${record.afterAlcohol}<br>
                            ÈÅãË°åÁä∂Ê≥Å: ${record.afterStatus}<br>
                            ‰∫§ÊõøÈÄöÂëä: ${record.afterHandover}
                            ${record.afterOther ? '<br>ÂÇôËÄÉ: ' + record.afterOther : ''}
                        </td>
                    </tr>
                `).join('')}
            </tbody>
        </table>
    </div>
</body>
</html>
                `;
                
                printWindow.document.write(html);
                printWindow.document.close();
            };

            // ‰∏ÄÊã¨ÁôªÈå≤Ê©üËÉΩ
            const handleBulkRegister = async () => {
                if (!bulkMonth) {
                    alert('Âπ¥Êúà„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                if (!formData.companyName || !formData.driverName || !formData.vehicleNumber) {
                    alert('‰ºöÁ§æÂêç„ÄÅÈÅãËª¢ËÄÖÂêç„ÄÅËªä‰∏°Áï™Âè∑„ÅØÂøÖÈ†à„Åß„Åô');
                    return;
                }

                const confirmMsg = `${bulkMonth}„ÅÆÊúà„ÅÆÂÖ®Âñ∂Ê•≠Êó•„Å´Ë®òÈå≤„Çí‰∏ÄÊã¨ÁôªÈå≤„Åó„Åæ„Åô„ÄÇ\nÈô§Â§ñ: ${excludeDays.map(d => ['Êó•','Êúà','ÁÅ´','Ê∞¥','Êú®','Èáë','Âúü'][d]).join(', ')}ÊõúÊó•\n${excludeDates.length > 0 ? 'Èô§Â§ñÊó•‰ªò: ' + excludeDates.join(', ') : ''}\n\n„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü`;
                
                if (!confirm(confirmMsg)) {
                    return;
                }

                try {
                    const [year, month] = bulkMonth.split('-').map(Number);
                    const daysInMonth = new Date(year, month, 0).getDate();
                    const batch = firebase.firestore().batch();
                    let count = 0;

                    for (let day = 1; day <= daysInMonth; day++) {
                        const date = new Date(year, month - 1, day);
                        const dayOfWeek = date.getDay();
                        const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

                        // Èô§Â§ñÊõúÊó•„ÉÅ„Çß„ÉÉ„ÇØ
                        if (excludeDays.includes(dayOfWeek)) {
                            continue;
                        }

                        // Èô§Â§ñÊó•‰ªò„ÉÅ„Çß„ÉÉ„ÇØ
                        if (excludeDates.includes(dateStr)) {
                            continue;
                        }

                        // Êó¢Â≠ò„ÅÆË®òÈå≤„Åå„ÅÇ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                        const existingRecord = records.find(r => r.date === dateStr);
                        if (existingRecord) {
                            continue; // Êó¢Â≠ò„ÅÆË®òÈå≤„ÅØ„Çπ„Ç≠„ÉÉ„Éó
                        }

                        const newRecord = {
                            date: dateStr,
                            companyName: formData.companyName,
                            officeName: formData.officeName,
                            driverName: formData.driverName,
                            vehicleNumber: formData.vehicleNumber,
                            beforeTime: formData.beforeTime,
                            beforeMethod: formData.beforeMethod,
                            beforeExecutor: formData.beforeExecutor,
                            beforeAlcoholTest: formData.beforeAlcoholTest,
                            beforeAlcohol: formData.beforeAlcohol,
                            beforeHealth: formData.beforeHealth,
                            beforeInspection: formData.beforeInspection,
                            beforeWeather: formData.beforeWeather,
                            beforeOther: '',
                            afterTime: formData.afterTime,
                            afterMethod: formData.afterMethod,
                            afterExecutor: formData.afterExecutor,
                            afterAlcoholTest: formData.afterAlcoholTest,
                            afterAlcohol: formData.afterAlcohol,
                            afterStatus: formData.afterStatus,
                            afterHandover: formData.afterHandover,
                            afterOther: '',
                            userId: user.uid,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        };

                        const docRef = firebase.firestore().collection('records').doc();
                        batch.set(docRef, newRecord);
                        count++;
                    }

                    await batch.commit();
                    alert(`${count}‰ª∂„ÅÆË®òÈå≤„Çí‰∏ÄÊã¨ÁôªÈå≤„Åó„Åæ„Åó„Åü`);
                    loadRecords(user.uid);
                    setActiveTab('list'); // Ë®òÈå≤‰∏ÄË¶ß„Çø„Éñ„Å´Âàá„ÇäÊõø„Åà
                } catch (error) {
                    console.error("‰∏ÄÊã¨ÁôªÈå≤„Ç®„É©„Éº:", error);
                    alert('‰∏ÄÊã¨ÁôªÈå≤„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
                }
            };

            // ÊúàÂÖ®‰Ωì„ÅÆÂâäÈô§Ê©üËÉΩ
            const handleBulkDelete = async (month) => {
                const targetRecords = records.filter(record => record.date.startsWith(month));
                
                if (targetRecords.length === 0) {
                    alert('ÂâäÈô§„Åô„ÇãË®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                    return;
                }

                const confirmMsg = `${month}„ÅÆË®òÈå≤ ${targetRecords.length}‰ª∂ „Çí„Åô„Åπ„Å¶ÂâäÈô§„Åó„Åæ„Åô„ÄÇ\n„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ\n\nÊú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü`;
                
                if (!confirm(confirmMsg)) {
                    return;
                }

                try {
                    const batch = firebase.firestore().batch();
                    
                    targetRecords.forEach(record => {
                        const docRef = firebase.firestore().collection('records').doc(record.id);
                        batch.delete(docRef);
                    });

                    await batch.commit();
                    alert(`${targetRecords.length}‰ª∂„ÅÆË®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü`);
                    loadRecords(user.uid);
                    setActiveTab('list'); // Ë®òÈå≤‰∏ÄË¶ß„Çø„Éñ„Å´Âàá„ÇäÊõø„Åà
                } catch (error) {
                    console.error("‰∏ÄÊã¨ÂâäÈô§„Ç®„É©„Éº:", error);
                    alert('‰∏ÄÊã¨ÂâäÈô§„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
                }
            };

            // Èô§Â§ñÊõúÊó•„ÅÆ„Éà„Ç∞„É´
            const toggleExcludeDay = (day) => {
                if (excludeDays.includes(day)) {
                    setExcludeDays(excludeDays.filter(d => d !== day));
                } else {
                    setExcludeDays([...excludeDays, day]);
                }
            };

            // Èô§Â§ñÊó•‰ªò„ÅÆ„Éà„Ç∞„É´
            const toggleExcludeDate = (date) => {
                if (excludeDates.includes(date)) {
                    setExcludeDates(excludeDates.filter(d => d !== date));
                } else {
                    setExcludeDates([...excludeDates, date]);
                }
            };

            // ÊåáÂÆöÊúà„ÅÆÊó•‰ªò„É™„Çπ„ÉàÁîüÊàê
            const getMonthDates = (yearMonth) => {
                if (!yearMonth) return [];
                const [year, month] = yearMonth.split('-').map(Number);
                const daysInMonth = new Date(year, month, 0).getDate();
                const dates = [];
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(year, month - 1, day);
                    const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    dates.push({
                        date: dateStr,
                        dayOfWeek: ['Êó•', 'Êúà', 'ÁÅ´', 'Ê∞¥', 'Êú®', 'Èáë', 'Âúü'][date.getDay()],
                        dayNum: date.getDay()
                    });
                }
                return dates;
            };

            if (loading) {
                return (
                    <div className="container">
                        <div className="header">
                            <h1>ÁÇπÂëºË®òÈå≤Á∞ø</h1>
                        </div>
                        <div className="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                    </div>
                );
            }

            if (!user) {
                return (
                    <div className="container">
                        <div className="header">
                            <h1>ÁÇπÂëºË®òÈå≤Á∞ø</h1>
                            <p>ËªΩË≤®Áâ©Ê•≠ËÄÖ„ÅÆÈÅãËª¢Êó•Â†±ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†</p>
                        </div>
                        <div className="login-container">
                            <button className="login-btn" onClick={handleLogin}>
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                </svg>
                                Google„Åß„É≠„Ç∞„Ç§„É≥
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="container">
                    <div className="header">
                        <h1>ÁÇπÂëºË®òÈå≤Á∞ø</h1>
                        <p>ËªΩË≤®Áâ©Ê•≠ËÄÖ„ÅÆÈÅãËª¢Êó•Â†±ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†</p>
                    </div>

                    <div className="content">
                        <div className="user-info">
                            <div>
                                <div className="user-name">üë§ {user.displayName || user.email}</div>
                            </div>
                            <button className="logout-btn" onClick={handleLogout}>„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
                        </div>

                        {/* „Çø„Éñ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */}
                        <div className="tabs">
                            <button 
                                className={`tab-button ${activeTab === 'input' ? 'active' : ''}`}
                                onClick={() => setActiveTab('input')}
                                type="button"
                            >
                                üìù Ë®òÈå≤ÂÖ•Âäõ
                            </button>
                            <button 
                                className={`tab-button ${activeTab === 'bulk' ? 'active' : ''}`}
                                onClick={() => setActiveTab('bulk')}
                                type="button"
                            >
                                üì¶ ‰∏ÄÊã¨Êìç‰Ωú
                            </button>
                            <button 
                                className={`tab-button ${activeTab === 'list' ? 'active' : ''}`}
                                onClick={() => setActiveTab('list')}
                                type="button"
                            >
                                üìã Ë®òÈå≤‰∏ÄË¶ß
                            </button>
                        </div>

                        {/* Ë®òÈå≤ÂÖ•Âäõ„Çø„Éñ */}
                        <div className={`tab-content ${activeTab === 'input' ? 'active' : ''}`}>
                        <form onSubmit={handleSubmit}>
                            <div className="form-section">
                                <h2>Âü∫Êú¨ÊÉÖÂ†±</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>Êó•‰ªò *</label>
                                        <input type="date" name="date" value={formData.date} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>‰ºöÁ§æÂêç</label>
                                        <input type="text" name="companyName" value={formData.companyName} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>Âñ∂Ê•≠ÊâÄÂêç</label>
                                        <input type="text" name="officeName" value={formData.officeName} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>ÈÅãËª¢ËÄÖÂêç *</label>
                                        <input type="text" name="driverName" value={formData.driverName} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>Ëªä‰∏°Áï™Âè∑ *</label>
                                        <input type="text" name="vehicleNumber" value={formData.vehicleNumber} onChange={handleInputChange} required />
                                    </div>
                                </div>
                            </div>

                            <div className="form-section">
                                <h2>Ê•≠ÂãôÂâçÁÇπÂëº</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>ÂÆüÊñΩÊó•ÊôÇ *</label>
                                        <input type="time" name="beforeTime" value={formData.beforeTime} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>ÁÇπÂëºÊñπÊ≥ï</label>
                                        <select name="beforeMethod" value={formData.beforeMethod} onChange={handleInputChange}>
                                            <option>ÂØæÈù¢</option>
                                            <option>ÈõªË©±</option>
                                            <option>„Åù„ÅÆ‰ªñ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÁÇπÂëºÂü∑Ë°åËÄÖ</label>
                                        <input type="text" name="beforeExecutor" value={formData.beforeExecutor} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>„Ç¢„É´„Ç≥„Éº„É´Ê§úÁü•Âô®‰ΩøÁî®</label>
                                        <select name="beforeAlcoholTest" value={formData.beforeAlcoholTest} onChange={handleInputChange}>
                                            <option>Êúâ</option>
                                            <option>ÁÑ°</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÈÖíÊ∞óÂ∏Ø„Å≥</label>
                                        <select name="beforeAlcohol" value={formData.beforeAlcohol} onChange={handleInputChange}>
                                            <option>ÁÑ°</option>
                                            <option>Êúâ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÂÅ•Â∫∑Áä∂ÊÖã</label>
                                        <select name="beforeHealth" value={formData.beforeHealth} onChange={handleInputChange}>
                                            <option>ËâØÂ•Ω</option>
                                            <option>Áñ≤Âä¥„ÅÇ„Çä</option>
                                            <option>Áù°Áú†‰∏çË∂≥</option>
                                            <option>‰ΩìË™ø‰∏çËâØ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Êó•Â∏∏ÁÇπÊ§ú</label>
                                        <select name="beforeInspection" value={formData.beforeInspection} onChange={handleInputChange}>
                                            <option>ËâØÂ•Ω</option>
                                            <option>Ë¶ÅÊ≥®ÊÑè</option>
                                            <option>Ë¶Å‰øÆÁêÜ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Â§©ÂÄô</label>
                                        <select name="beforeWeather" value={formData.beforeWeather} onChange={handleInputChange}>
                                            <option>Êô¥</option>
                                            <option>Êõá</option>
                                            <option>Èõ®</option>
                                            <option>Èõ™</option>
                                        </select>
                                    </div>
                                    <div className="form-group" style={{gridColumn: '1 / -1'}}>
                                        <label>„Åù„ÅÆ‰ªñÊåáÁ§∫‰∫ãÈ†Ö</label>
                                        <textarea name="beforeOther" value={formData.beforeOther} onChange={handleInputChange} rows="2"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div className="form-section">
                                <h2>Ê•≠ÂãôÂæåÁÇπÂëº</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>ÂÆüÊñΩÊó•ÊôÇ *</label>
                                        <input type="time" name="afterTime" value={formData.afterTime} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>ÁÇπÂëºÊñπÊ≥ï</label>
                                        <select name="afterMethod" value={formData.afterMethod} onChange={handleInputChange}>
                                            <option>ÂØæÈù¢</option>
                                            <option>ÈõªË©±</option>
                                            <option>„Åù„ÅÆ‰ªñ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÁÇπÂëºÂü∑Ë°åËÄÖ</label>
                                        <input type="text" name="afterExecutor" value={formData.afterExecutor} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>„Ç¢„É´„Ç≥„Éº„É´Ê§úÁü•Âô®‰ΩøÁî®</label>
                                        <select name="afterAlcoholTest" value={formData.afterAlcoholTest} onChange={handleInputChange}>
                                            <option>Êúâ</option>
                                            <option>ÁÑ°</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÈÖíÊ∞óÂ∏Ø„Å≥</label>
                                        <select name="afterAlcohol" value={formData.afterAlcohol} onChange={handleInputChange}>
                                            <option>ÁÑ°</option>
                                            <option>Êúâ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÈÅãË°åÁä∂Ê≥Å</label>
                                        <select name="afterStatus" value={formData.afterStatus} onChange={handleInputChange}>
                                            <option>Áï∞Â∏∏„Å™„Åó</option>
                                            <option>ÈÅÖÂª∂„ÅÇ„Çä</option>
                                            <option>‰∫ãÊïÖ„ÅÇ„Çä</option>
                                            <option>ÈÅïÂèç„ÅÇ„Çä</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>‰∫§ÊõøÈÅãËª¢ËÄÖ„Å∏„ÅÆÈÄöÂëä</label>
                                        <select name="afterHandover" value={formData.afterHandover} onChange={handleInputChange}>
                                            <option>„Å™„Åó</option>
                                            <option>„ÅÇ„Çä</option>
                                        </select>
                                    </div>
                                    <div className="form-group" style={{gridColumn: '1 / -1'}}>
                                        <label>„Åù„ÅÆ‰ªñÊåáÁ§∫‰∫ãÈ†Ö</label>
                                        <textarea name="afterOther" value={formData.afterOther} onChange={handleInputChange} rows="2"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div className="btn-group">
                                <button type="submit" className="btn btn-primary">
                                    {editingId ? 'Êõ¥Êñ∞„Åô„Çã' : 'Ë®òÈå≤„Çí‰øùÂ≠ò'}
                                </button>
                                {editingId && (
                                    <button type="button" className="btn btn-secondary" onClick={() => {
                                        setEditingId(null);
                                        const initialFormData = {
                                            date: new Date().toISOString().split('T')[0],
                                            companyName: '',
                                            officeName: '',
                                            driverName: '',
                                            vehicleNumber: '',
                                            beforeTime: '',
                                            beforeMethod: 'ÂØæÈù¢',
                                            beforeExecutor: '',
                                            beforeAlcoholTest: 'Êúâ',
                                            beforeAlcohol: 'ÁÑ°',
                                            beforeHealth: 'ËâØÂ•Ω',
                                            beforeInspection: 'ËâØÂ•Ω',
                                            beforeWeather: 'Êô¥',
                                            beforeOther: '',
                                            afterTime: '',
                                            afterMethod: 'ÂØæÈù¢',
                                            afterExecutor: '',
                                            afterAlcoholTest: 'Êúâ',
                                            afterAlcohol: 'ÁÑ°',
                                            afterStatus: 'Áï∞Â∏∏„Å™„Åó',
                                            afterHandover: '„Å™„Åó',
                                            afterOther: ''
                                        };
                                        setFormData(initialFormData);
                                    }}>
                                        „Ç≠„É£„É≥„Çª„É´
                                    </button>
                                )}
                            </div>
                        </form>
                        </div>

                        {/* ‰∏ÄÊã¨Êìç‰Ωú„Çø„Éñ */}
                        <div className={`tab-content ${activeTab === 'bulk' ? 'active' : ''}`}>
                            <div className="form-section">
                                <h2>‰∏ÄÊã¨Êìç‰Ωú</h2>
                                
                                {/* ‰∏ÄÊã¨ÁôªÈå≤ */}
                                <div style={{marginBottom: '30px', padding: '20px', background: '#f7fafc', borderRadius: '10px'}}>
                                    <h3 style={{fontSize: '18px', marginBottom: '15px', color: '#2d3748'}}>üìù ÊúàÈñì‰∏ÄÊã¨ÁôªÈå≤</h3>
                                    <p style={{fontSize: '14px', color: '#718096', marginBottom: '15px'}}>
                                        ÊåáÂÆö„Åó„ÅüÊúà„ÅÆÂÖ®Âñ∂Ê•≠Êó•„Å´Âêå„ÅòÂÜÖÂÆπ„ÅÆË®òÈå≤„Çí‰∏ÄÊã¨ÁôªÈå≤„Åó„Åæ„Åô
                                    </p>
                                    
                                    <div className="form-group" style={{marginBottom: '15px'}}>
                                        <label>ÂØæË±°Âπ¥Êúà</label>
                                        <input 
                                            type="month" 
                                            value={bulkMonth}
                                            onChange={(e) => setBulkMonth(e.target.value)}
                                            style={{maxWidth: '200px'}}
                                        />
                                    </div>

                                    <div className="form-group" style={{marginBottom: '15px'}}>
                                        <label>Èô§Â§ñ„Åô„ÇãÊõúÊó•</label>
                                        <div style={{display: 'flex', gap: '10px', flexWrap: 'wrap'}}>
                                            {['Êó•', 'Êúà', 'ÁÅ´', 'Ê∞¥', 'Êú®', 'Èáë', 'Âúü'].map((day, index) => (
                                                <label key={index} style={{display: 'flex', alignItems: 'center', gap: '5px', cursor: 'pointer'}}>
                                                    <input 
                                                        type="checkbox"
                                                        checked={excludeDays.includes(index)}
                                                        onChange={() => toggleExcludeDay(index)}
                                                    />
                                                    <span>{day}ÊõúÊó•</span>
                                                </label>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="form-group" style={{marginBottom: '15px'}}>
                                        <label>Èô§Â§ñ„Åô„ÇãÊó•‰ªò„ÇíÈÅ∏Êäû</label>
                                        <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(120px, 1fr))', gap: '8px', maxHeight: '200px', overflow: 'auto', padding: '10px', background: 'white', borderRadius: '8px', border: '1px solid #e2e8f0'}}>
                                            {getMonthDates(bulkMonth).map(({date, dayOfWeek, dayNum}) => (
                                                <label key={date} style={{
                                                    display: 'flex', 
                                                    alignItems: 'center', 
                                                    gap: '5px', 
                                                    cursor: 'pointer',
                                                    padding: '5px',
                                                    borderRadius: '4px',
                                                    background: excludeDays.includes(dayNum) ? '#f0f0f0' : 'white',
                                                    opacity: excludeDays.includes(dayNum) ? 0.5 : 1
                                                }}>
                                                    <input 
                                                        type="checkbox"
                                                        checked={excludeDates.includes(date)}
                                                        onChange={() => toggleExcludeDate(date)}
                                                        disabled={excludeDays.includes(dayNum)}
                                                    />
                                                    <span style={{fontSize: '12px'}}>{date.split('-')[2]}Êó•({dayOfWeek})</span>
                                                </label>
                                            ))}
                                        </div>
                                        <p style={{fontSize: '12px', color: '#718096', marginTop: '5px'}}>
                                            ‚ÄªÈô§Â§ñÊõúÊó•„Å´Ë©≤ÂΩì„Åô„ÇãÊó•„ÅØ„Ç∞„É¨„ÉºË°®Á§∫„Åï„Çå„Åæ„Åô
                                        </p>
                                    </div>

                                    <div style={{background: '#fff5e6', padding: '15px', borderRadius: '8px', marginBottom: '15px'}}>
                                        <p style={{fontSize: '14px', color: '#744210', marginBottom: '8px'}}>
                                            <strong>‚ö†Ô∏è Ê≥®ÊÑè‰∫ãÈ†Ö:</strong>
                                        </p>
                                        <ul style={{fontSize: '13px', color: '#744210', paddingLeft: '20px', margin: 0}}>
                                            <li>‰∏äË®ò„Éï„Ç©„Éº„É†„ÅßÂÖ•Âäõ„Åó„ÅüÂü∫Êú¨ÊÉÖÂ†±„ÉªÊ•≠ÂãôÂâç„ÉªÊ•≠ÂãôÂæå„ÅÆË®≠ÂÆö„Åå‰ΩøÁî®„Åï„Çå„Åæ„Åô</li>
                                            <li>ÊôÇÂàª„ÇÑÂÇôËÄÉ„ÅØÁ©∫Ê¨Ñ„ÅßÁôªÈå≤„Åï„Çå„Åæ„ÅôÔºàÂæå„ÅßÂÄãÂà•„Å´Á∑®ÈõÜ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºâ</li>
                                            <li>Êó¢„Å´Ë®òÈå≤„ÅåÂ≠òÂú®„Åô„ÇãÊó•„ÅØ„Çπ„Ç≠„ÉÉ„Éó„Åï„Çå„Åæ„Åô</li>
                                        </ul>
                                    </div>

                                    <button 
                                        type="button"
                                        className="btn btn-primary"
                                        onClick={handleBulkRegister}
                                        style={{width: '100%', maxWidth: '300px'}}
                                    >
                                        ‰∏ÄÊã¨ÁôªÈå≤„ÇíÂÆüË°å
                                    </button>
                                </div>

                                {/* ‰∏ÄÊã¨ÂâäÈô§ */}
                                <div style={{padding: '20px', background: '#fff5f5', borderRadius: '10px', border: '2px solid #fc8181'}}>
                                    <h3 style={{fontSize: '18px', marginBottom: '15px', color: '#c53030'}}>üóëÔ∏è ÊúàÈñì‰∏ÄÊã¨ÂâäÈô§</h3>
                                    <p style={{fontSize: '14px', color: '#744210', marginBottom: '15px'}}>
                                        ÊåáÂÆö„Åó„ÅüÊúà„ÅÆË®òÈå≤„Çí„Åô„Åπ„Å¶ÂâäÈô§„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ
                                    </p>
                                    
                                    <div className="month-selector" style={{marginBottom: '15px'}}>
                                        <label>ÂâäÈô§ÂØæË±°Êúà:</label>
                                        <select id="bulkDeleteMonth" defaultValue={new Date().toISOString().slice(0, 7)}>
                                            {Array.from({length: 12}, (_, i) => {
                                                const d = new Date();
                                                d.setMonth(d.getMonth() - i);
                                                const monthStr = d.toISOString().slice(0, 7);
                                                const count = records.filter(r => r.date.startsWith(monthStr)).length;
                                                return <option key={monthStr} value={monthStr}>{monthStr} ({count}‰ª∂)</option>;
                                            })}
                                        </select>
                                        <button 
                                            type="button"
                                            className="btn btn-delete" 
                                            onClick={() => {
                                                const month = document.getElementById('bulkDeleteMonth').value;
                                                handleBulkDelete(month);
                                            }}
                                        >
                                            „Åì„ÅÆÊúà„ÅÆË®òÈå≤„Çí„Åô„Åπ„Å¶ÂâäÈô§
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Ë®òÈå≤‰∏ÄË¶ß„Çø„Éñ */}
                        <div className={`tab-content ${activeTab === 'list' ? 'active' : ''}`}>
                            <div className="records-list">
                                <h2 style={{marginBottom: '20px', color: '#2d3748'}}>Ë®òÈå≤‰∏ÄË¶ß</h2>
                                
                                <div className="month-selector">
                                    <label style={{fontWeight: '600'}}>ÊúàÂà•PDFÂá∫Âäõ:</label>
                                    <select id="monthSelect" defaultValue={new Date().toISOString().slice(0, 7)}>
                                        {Array.from({length: 12}, (_, i) => {
                                            const d = new Date();
                                            d.setMonth(d.getMonth() - i);
                                            const monthStr = d.toISOString().slice(0, 7);
                                            return <option key={monthStr} value={monthStr}>{monthStr}</option>;
                                        })}
                                    </select>
                                    <button className="btn btn-tertiary" onClick={() => {
                                        const month = document.getElementById('monthSelect').value;
                                        generatePDF(month);
                                    }}>
                                        PDFÂá∫Âäõ
                                    </button>
                                </div>

                            {records.map(record => (
                                <div key={record.id} className="record-item">
                                    <div className="record-header">
                                        <div className="record-date">
                                            üìÖ {record.date} - {record.driverName} ({record.vehicleNumber})
                                        </div>
                                        <div className="record-actions">
                                            <button className="btn-small btn-edit" onClick={() => handleEdit(record)}>Á∑®ÈõÜ</button>
                                            <button className="btn-small btn-delete" onClick={() => handleDelete(record.id)}>ÂâäÈô§</button>
                                        </div>
                                    </div>
                                    <div className="record-details">
                                        <strong>Ê•≠ÂãôÂâç:</strong> {record.beforeTime} ({record.beforeMethod}) - ÂÅ•Â∫∑: {record.beforeHealth}<br/>
                                        <strong>Ê•≠ÂãôÂæå:</strong> {record.afterTime} ({record.afterMethod}) - Áä∂Ê≥Å: {record.afterStatus}
                                    </div>
                                </div>
                            ))}
                            
                            {records.length === 0 && (
                                <div style={{textAlign: 'center', padding: '40px', color: '#a0aec0'}}>
                                    „Åæ„Å†Ë®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì
                                </div>
                            )}
                        </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>