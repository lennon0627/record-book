<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁÇπÂëºË®òÈå≤Á∞ø</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
        }

        .header {
            background: white;
            color: #202124;
            padding: 16px 24px;
            border-bottom: 1px solid #e0e0e0;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .header h1 {
            font-size: 22px;
            font-weight: 400;
            margin-bottom: 0;
        }

        .login-container {
            padding: 80px 30px;
            text-align: center;
            background: white;
        }

        .login-btn {
            background: #1a73e8;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 500;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .login-btn:hover {
            background: #1765cc;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .content {
            padding: 24px;
        }

        .user-info {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
            border: 1px solid #e0e0e0;
        }

        .user-name {
            font-weight: 400;
            color: #202124;
            font-size: 14px;
        }

        .logout-btn {
            background: white;
            color: #5f6368;
            border: 1px solid #dadce0;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s;
        }

        .logout-btn:hover {
            background: #f8f9fa;
            border-color: #dadce0;
        }

        .form-section {
            background: white;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }

        .form-section h2 {
            color: #202124;
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e0e0e0;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 400;
            color: #5f6368;
            margin-bottom: 6px;
            font-size: 14px;
        }

        input, select, textarea {
            padding: 10px 12px;
            border: 1px solid #dadce0;
            border-radius: 4px;
            font-size: 14px;
            transition: all 0.2s;
            font-family: inherit;
            color: #202124;
            background: white;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #1a73e8;
            box-shadow: 0 0 0 1px #1a73e8;
        }

        .btn-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 24px;
        }

        .btn {
            padding: 10px 24px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            flex: 1;
            min-width: 120px;
        }

        .btn-primary {
            background: #1a73e8;
            color: white;
        }

        .btn-primary:hover {
            background: #1765cc;
            box-shadow: 0 1px 2px rgba(0,0,0,0.15);
        }

        .btn-secondary {
            background: white;
            color: #5f6368;
            border: 1px solid #dadce0;
        }

        .btn-secondary:hover {
            background: #f8f9fa;
        }

        .btn-tertiary {
            background: #ea8600;
            color: white;
        }

        .btn-tertiary:hover {
            background: #d37b00;
        }

        .records-list {
            margin-top: 24px;
        }

        .record-item {
            background: white;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 12px;
            border: 1px solid #e0e0e0;
            transition: all 0.2s;
        }

        .record-item:hover {
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
            border-color: #dadce0;
        }

        .record-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .record-date {
            font-weight: 500;
            color: #202124;
            font-size: 15px;
        }

        .record-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 13px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        .btn-edit {
            background: white;
            color: #1a73e8;
            border: 1px solid #dadce0;
        }

        .btn-edit:hover {
            background: #e8f0fe;
            border-color: #1a73e8;
        }

        .btn-delete {
            background: white;
            color: #d93025;
            border: 1px solid #dadce0;
        }

        .btn-delete:hover {
            background: #fce8e6;
            border-color: #d93025;
        }

        .record-details {
            color: #5f6368;
            font-size: 13px;
            line-height: 1.6;
        }

        .month-selector {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .month-selector select {
            flex: 0 0 180px;
        }

        .month-selector label {
            font-size: 14px;
            color: #5f6368;
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .content {
                padding: 16px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }

            .month-selector {
                flex-direction: column;
                align-items: stretch;
            }

            .month-selector select {
                flex: 1;
            }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #5f6368;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // FirebaseË®≠ÂÆö
        const firebaseConfig = {
            apiKey: "AIzaSyDjAfZXyrzQlHIT8qpj0vynIznrJDFcUe4",
            authDomain: "tenko-kiroku.firebaseapp.com",
            projectId: "tenko-kiroku",
            storageBucket: "tenko-kiroku.firebasestorage.app",
            messagingSenderId: "67100796956",
            appId: "1:67100796956:web:c57a2f0449e0a766a217d9",
            measurementId: "G-CDJNEZ5LWX"
        };

        // FirebaseÂàùÊúüÂåñ
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }

        function App() {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [records, setRecords] = useState([]);
            const [editingId, setEditingId] = useState(null);
            
            // „Éï„Ç©„Éº„É†„ÅÆÁä∂ÊÖã
            const [formData, setFormData] = useState({
                date: new Date().toISOString().split('T')[0],
                companyName: '',
                officeName: '',
                driverName: '',
                vehicleNumber: '',
                // Ê•≠ÂãôÂâçÁÇπÂëº
                beforeTime: '',
                beforeMethod: 'ÂØæÈù¢',
                beforeExecutor: '',
                beforeAlcoholTest: 'Êúâ',
                beforeAlcohol: 'ÁÑ°',
                beforeHealth: 'ËâØÂ•Ω',
                beforeInspection: 'ËâØÂ•Ω',
                beforeWeather: 'Êô¥',
                beforeOther: '',
                // Ê•≠ÂãôÂæåÁÇπÂëº
                afterTime: '',
                afterMethod: 'ÂØæÈù¢',
                afterExecutor: '',
                afterAlcoholTest: 'Êúâ',
                afterAlcohol: 'ÁÑ°',
                afterStatus: 'Áï∞Â∏∏„Å™„Åó',
                afterHandover: '„Å™„Åó',
                afterOther: ''
            });

            // Firestore„Åã„Çâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„ÇÄ
            const loadRecords = async (userId) => {
                try {
                    const snapshot = await firebase.firestore()
                        .collection('records')
                        .where('userId', '==', userId)
                        .orderBy('date', 'desc')
                        .get();
                    
                    const loadedRecords = [];
                    snapshot.forEach(doc => {
                        loadedRecords.push({ id: doc.id, ...doc.data() });
                    });
                    setRecords(loadedRecords);

                    // ÂÖ•Âäõ„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíË™≠„ÅøËæº„ÇÄ
                    const templateDoc = await firebase.firestore()
                        .collection('userTemplates')
                        .doc(userId)
                        .get();
                    
                    if (templateDoc.exists) {
                        const template = templateDoc.data();
                        setFormData(prev => ({
                            ...template,
                            date: new Date().toISOString().split('T')[0], // Êó•‰ªò„ÅØÂ∏∏„Å´‰ªäÊó•
                            beforeTime: '', // ÊôÇÂàª„ÅØ„ÇØ„É™„Ç¢
                            afterTime: '',  // ÊôÇÂàª„ÅØ„ÇØ„É™„Ç¢
                            beforeOther: '', // ÂÇôËÄÉ„ÅØ„ÇØ„É™„Ç¢
                            afterOther: ''   // ÂÇôËÄÉ„ÅØ„ÇØ„É™„Ç¢
                        }));
                    }
                } catch (error) {
                    console.error("„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„Ç®„É©„Éº:", error);
                }
            };

            useEffect(() => {
                const unsubscribe = firebase.auth().onAuthStateChanged((user) => {
                    setUser(user);
                    setLoading(false);
                    if (user) {
                        loadRecords(user.uid);
                    }
                });
                return () => unsubscribe();
            }, []);

            const handleLogin = async () => {
                try {
                    const provider = new firebase.auth.GoogleAuthProvider();
                    await firebase.auth().signInWithPopup(provider);
                } catch (error) {
                    console.error("„É≠„Ç∞„Ç§„É≥„Ç®„É©„Éº:", error);
                    alert("„É≠„Ç∞„Ç§„É≥„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: " + error.message);
                }
            };

            const handleLogout = () => {
                firebase.auth().signOut();
            };

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                try {
                    if (editingId) {
                        // Á∑®ÈõÜ
                        await firebase.firestore()
                            .collection('records')
                            .doc(editingId)
                            .update(formData);
                        
                        const updatedRecords = records.map(record => 
                            record.id === editingId ? { ...formData, id: editingId, userId: user.uid } : record
                        );
                        setRecords(updatedRecords);
                        setEditingId(null);
                        alert('Êõ¥Êñ∞„Åó„Åæ„Åó„Åü');
                    } else {
                        // Êñ∞Ë¶èËøΩÂä†
                        const newRecord = {
                            ...formData,
                            userId: user.uid,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        };
                        
                        const docRef = await firebase.firestore()
                            .collection('records')
                            .add(newRecord);
                        
                        setRecords([{ ...newRecord, id: docRef.id }, ...records]);
                        alert('‰øùÂ≠ò„Åó„Åæ„Åó„Åü');
                    }
                    
                    // ÂÖ•Âäõ„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíFirestore„Å´‰øùÂ≠ò
                    await firebase.firestore()
                        .collection('userTemplates')
                        .doc(user.uid)
                        .set({
                            companyName: formData.companyName,
                            officeName: formData.officeName,
                            driverName: formData.driverName,
                            vehicleNumber: formData.vehicleNumber,
                            beforeMethod: formData.beforeMethod,
                            beforeExecutor: formData.beforeExecutor,
                            beforeAlcoholTest: formData.beforeAlcoholTest,
                            beforeAlcohol: formData.beforeAlcohol,
                            beforeHealth: formData.beforeHealth,
                            beforeInspection: formData.beforeInspection,
                            beforeWeather: formData.beforeWeather,
                            afterMethod: formData.afterMethod,
                            afterExecutor: formData.afterExecutor,
                            afterAlcoholTest: formData.afterAlcoholTest,
                            afterAlcohol: formData.afterAlcohol,
                            afterStatus: formData.afterStatus,
                            afterHandover: formData.afterHandover,
                            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                    
                    // „Éï„Ç©„Éº„É†„Çí„É™„Çª„ÉÉ„ÉàÔºàÊó•‰ªò„ÉªÊôÇÂàª„ÉªÂÇôËÄÉ„ÅÆ„Åø„ÇØ„É™„Ç¢„ÄÅ„Åù„ÅÆ‰ªñ„ÅØ‰øùÊåÅÔºâ
                    setFormData(prev => ({
                        ...prev,
                        date: new Date().toISOString().split('T')[0],
                        beforeTime: '',
                        beforeOther: '',
                        afterTime: '',
                        afterOther: ''
                    }));
                } catch (error) {
                    console.error("‰øùÂ≠ò„Ç®„É©„Éº:", error);
                    alert('‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
                }
            };

            const handleEdit = (record) => {
                setFormData(record);
                setEditingId(record.id);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const handleDelete = async (id) => {
                if (confirm('„Åì„ÅÆË®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åô„Åã?')) {
                    try {
                        await firebase.firestore()
                            .collection('records')
                            .doc(id)
                            .delete();
                        
                        const updatedRecords = records.filter(record => record.id !== id);
                        setRecords(updatedRecords);
                        alert('ÂâäÈô§„Åó„Åæ„Åó„Åü');
                    } catch (error) {
                        console.error("ÂâäÈô§„Ç®„É©„Éº:", error);
                        alert('ÂâäÈô§„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
                    }
                }
            };

            const generatePDF = (month) => {
                const filteredRecords = records.filter(record => 
                    record.date.startsWith(month)
                ).sort((a, b) => a.date.localeCompare(b.date));

                if (filteredRecords.length === 0) {
                    alert('ÈÅ∏Êäû„Åó„ÅüÊúà„ÅÆ„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                    return;
                }

                // Âç∞Âà∑Áî®„ÅÆ„Ç¶„Ç£„É≥„Éâ„Ç¶„ÇíÈñã„Åè
                const printWindow = window.open('', '_blank');
                
                // HTMLÁîüÊàê
                const html = `
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes">
    <title>ÁÇπÂëºË®òÈå≤Á∞ø ${month.split('-')[0]}Âπ¥${month.split('-')[1]}Êúà</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            width: 100%;
            height: 100%;
        }
        
        body {
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', 'Meiryo', sans-serif;
            width: 100%;
            min-height: 100vh;
            padding: 15px;
            background: #f5f5f5;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            font-size: 24px;
            margin-bottom: 8px;
            color: #333;
        }
        
        .subtitle {
            text-align: center;
            font-size: 16px;
            margin-bottom: 20px;
            color: #666;
        }
        
        .no-print {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        
        .print-btn {
            background: #5a67d8;
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 8px;
            display: inline-block;
            min-width: 180px;
            touch-action: manipulation;
        }
        
        .print-btn:active {
            background: #4a57c8;
            transform: scale(0.98);
        }
        
        .print-btn.secondary {
            background: #6b7280;
        }
        
        .print-btn.secondary:active {
            background: #4b5563;
        }
        
        .instruction {
            color: #666;
            margin-top: 15px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            margin-top: 20px;
        }
        
        th, td {
            border: 1px solid #333;
            padding: 8px;
            text-align: left;
            vertical-align: top;
        }
        
        th {
            background-color: #5a67d8;
            color: white;
            font-weight: bold;
            text-align: center;
            font-size: 12px;
        }
        
        .date-col { width: 10%; }
        .name-col { width: 10%; }
        .vehicle-col { width: 12%; }
        .before-col { width: 17%; }
        .status-col { width: 17%; }
        .after-col { width: 17%; }
        
        /* „Çπ„Éû„ÉõË°®Á§∫ÊôÇ */
        @media screen and (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            .subtitle {
                font-size: 14px;
            }
            
            .print-btn {
                display: block;
                width: 100%;
                max-width: 400px;
                margin: 10px auto;
                padding: 18px 20px;
                font-size: 16px;
            }
            
            table {
                font-size: 9px;
            }
            
            th {
                font-size: 10px;
                padding: 6px 4px;
            }
            
            td {
                padding: 6px 4px;
            }
        }
        
        /* Ë∂ÖÂ∞èÂûã„Çπ„Éû„Éõ */
        @media screen and (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 18px;
            }
            
            .subtitle {
                font-size: 13px;
            }
            
            table {
                font-size: 8px;
            }
            
            th {
                font-size: 9px;
                padding: 5px 3px;
            }
            
            td {
                padding: 5px 3px;
            }
        }
        
        /* Âç∞Âà∑ÊôÇ */
        @media print {
            @page {
                size: A4 landscape;
                margin: 10mm;
            }
            
            html, body {
                width: 100%;
                height: 100%;
                background: white;
            }
            
            body {
                padding: 0;
            }
            
            .container {
                max-width: none;
                padding: 0;
                box-shadow: none;
                border-radius: 0;
            }
            
            .no-print {
                display: none;
            }
            
            table {
                font-size: 10px;
            }
            
            th {
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ÁÇπÂëºË®òÈå≤Á∞ø</h1>
        <div class="subtitle">${month.split('-')[0]}Âπ¥${month.split('-')[1]}Êúà</div>
        
        <div class="no-print">
            <button class="print-btn" onclick="window.print()">üìÑ PDF„Å®„Åó„Å¶‰øùÂ≠ò</button>
            <button class="print-btn secondary" onclick="window.close()">‚úï Èñâ„Åò„Çã</button>
            <p class="instruction">
                ‚Äª ‰∏ä„ÅÆ„ÄåPDF„Å®„Åó„Å¶‰øùÂ≠ò„Äç„Éú„Çø„É≥„Çí„Çø„ÉÉ„Éó„Åó„ÄÅ<br>
                Âç∞Âà∑ÁîªÈù¢„Åß„ÄåPDF„Å®„Åó„Å¶‰øùÂ≠ò„Äç„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ
            </p>
        </div>
        
        <table>
            <thead>
                <tr>
                    <th class="date-col">Êó•‰ªò</th>
                    <th class="name-col">ÈÅãËª¢ËÄÖÂêç</th>
                    <th class="vehicle-col">Ëªä‰∏°Áï™Âè∑</th>
                    <th class="before-col">Ê•≠ÂãôÂâçÁÇπÂëº</th>
                    <th class="status-col">Ê•≠ÂãôÂâçÁä∂Ê≥Å</th>
                    <th class="after-col">Ê•≠ÂãôÂæåÁÇπÂëº</th>
                    <th class="status-col">Ê•≠ÂãôÂæåÁä∂Ê≥Å</th>
                </tr>
            </thead>
            <tbody>
                ${filteredRecords.map(record => `
                    <tr>
                        <td>${record.date}</td>
                        <td>${record.driverName}</td>
                        <td>${record.vehicleNumber}</td>
                        <td>
                            ÊôÇÂàª: ${record.beforeTime}<br>
                            ÊñπÊ≥ï: ${record.beforeMethod}<br>
                            Âü∑Ë°åËÄÖ: ${record.beforeExecutor || '-'}
                        </td>
                        <td>
                            „Ç¢„É´„Ç≥„Éº„É´Ê§úÁü•Âô®: ${record.beforeAlcoholTest}<br>
                            ÈÖíÊ∞óÂ∏Ø„Å≥: ${record.beforeAlcohol}<br>
                            ÂÅ•Â∫∑Áä∂ÊÖã: ${record.beforeHealth}<br>
                            Êó•Â∏∏ÁÇπÊ§ú: ${record.beforeInspection}<br>
                            Â§©ÂÄô: ${record.beforeWeather}
                            ${record.beforeOther ? '<br>ÂÇôËÄÉ: ' + record.beforeOther : ''}
                        </td>
                        <td>
                            ÊôÇÂàª: ${record.afterTime}<br>
                            ÊñπÊ≥ï: ${record.afterMethod}<br>
                            Âü∑Ë°åËÄÖ: ${record.afterExecutor || '-'}
                        </td>
                        <td>
                            „Ç¢„É´„Ç≥„Éº„É´Ê§úÁü•Âô®: ${record.afterAlcoholTest}<br>
                            ÈÖíÊ∞óÂ∏Ø„Å≥: ${record.afterAlcohol}<br>
                            ÈÅãË°åÁä∂Ê≥Å: ${record.afterStatus}<br>
                            ‰∫§ÊõøÈÄöÂëä: ${record.afterHandover}
                            ${record.afterOther ? '<br>ÂÇôËÄÉ: ' + record.afterOther : ''}
                        </td>
                    </tr>
                `).join('')}
            </tbody>
        </table>
    </div>
</body>
</html>
                `;
                
                printWindow.document.write(html);
                printWindow.document.close();
            };

            if (loading) {
                return (
                    <div className="container">
                        <div className="header">
                            <h1>ÁÇπÂëºË®òÈå≤Á∞ø</h1>
                        </div>
                        <div className="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                    </div>
                );
            }

            if (!user) {
                return (
                    <div className="container">
                        <div className="header">
                            <h1>ÁÇπÂëºË®òÈå≤Á∞ø</h1>
                            <p>ËªΩË≤®Áâ©Ê•≠ËÄÖ„ÅÆÈÅãËª¢Êó•Â†±ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†</p>
                        </div>
                        <div className="login-container">
                            <button className="login-btn" onClick={handleLogin}>
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                </svg>
                                Google„Åß„É≠„Ç∞„Ç§„É≥
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="container">
                    <div className="header">
                        <h1>ÁÇπÂëºË®òÈå≤Á∞ø</h1>
                        <p>ËªΩË≤®Áâ©Ê•≠ËÄÖ„ÅÆÈÅãËª¢Êó•Â†±ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†</p>
                    </div>

                    <div className="content">
                        <div className="user-info">
                            <div>
                                <div className="user-name">üë§ {user.displayName || user.email}</div>
                            </div>
                            <button className="logout-btn" onClick={handleLogout}>„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
                        </div>

                        <form onSubmit={handleSubmit}>
                            <div className="form-section">
                                <h2>Âü∫Êú¨ÊÉÖÂ†±</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>Êó•‰ªò *</label>
                                        <input type="date" name="date" value={formData.date} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>‰ºöÁ§æÂêç</label>
                                        <input type="text" name="companyName" value={formData.companyName} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>Âñ∂Ê•≠ÊâÄÂêç</label>
                                        <input type="text" name="officeName" value={formData.officeName} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>ÈÅãËª¢ËÄÖÂêç *</label>
                                        <input type="text" name="driverName" value={formData.driverName} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>Ëªä‰∏°Áï™Âè∑ *</label>
                                        <input type="text" name="vehicleNumber" value={formData.vehicleNumber} onChange={handleInputChange} required />
                                    </div>
                                </div>
                            </div>

                            <div className="form-section">
                                <h2>Ê•≠ÂãôÂâçÁÇπÂëº</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>ÂÆüÊñΩÊó•ÊôÇ *</label>
                                        <input type="time" name="beforeTime" value={formData.beforeTime} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>ÁÇπÂëºÊñπÊ≥ï</label>
                                        <select name="beforeMethod" value={formData.beforeMethod} onChange={handleInputChange}>
                                            <option>ÂØæÈù¢</option>
                                            <option>ÈõªË©±</option>
                                            <option>„Åù„ÅÆ‰ªñ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÁÇπÂëºÂü∑Ë°åËÄÖ</label>
                                        <input type="text" name="beforeExecutor" value={formData.beforeExecutor} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>„Ç¢„É´„Ç≥„Éº„É´Ê§úÁü•Âô®‰ΩøÁî®</label>
                                        <select name="beforeAlcoholTest" value={formData.beforeAlcoholTest} onChange={handleInputChange}>
                                            <option>Êúâ</option>
                                            <option>ÁÑ°</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÈÖíÊ∞óÂ∏Ø„Å≥</label>
                                        <select name="beforeAlcohol" value={formData.beforeAlcohol} onChange={handleInputChange}>
                                            <option>ÁÑ°</option>
                                            <option>Êúâ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÂÅ•Â∫∑Áä∂ÊÖã</label>
                                        <select name="beforeHealth" value={formData.beforeHealth} onChange={handleInputChange}>
                                            <option>ËâØÂ•Ω</option>
                                            <option>Áñ≤Âä¥„ÅÇ„Çä</option>
                                            <option>Áù°Áú†‰∏çË∂≥</option>
                                            <option>‰ΩìË™ø‰∏çËâØ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Êó•Â∏∏ÁÇπÊ§ú</label>
                                        <select name="beforeInspection" value={formData.beforeInspection} onChange={handleInputChange}>
                                            <option>ËâØÂ•Ω</option>
                                            <option>Ë¶ÅÊ≥®ÊÑè</option>
                                            <option>Ë¶Å‰øÆÁêÜ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Â§©ÂÄô</label>
                                        <select name="beforeWeather" value={formData.beforeWeather} onChange={handleInputChange}>
                                            <option>Êô¥</option>
                                            <option>Êõá</option>
                                            <option>Èõ®</option>
                                            <option>Èõ™</option>
                                        </select>
                                    </div>
                                    <div className="form-group" style={{gridColumn: '1 / -1'}}>
                                        <label>„Åù„ÅÆ‰ªñÊåáÁ§∫‰∫ãÈ†Ö</label>
                                        <textarea name="beforeOther" value={formData.beforeOther} onChange={handleInputChange} rows="2"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div className="form-section">
                                <h2>Ê•≠ÂãôÂæåÁÇπÂëº</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>ÂÆüÊñΩÊó•ÊôÇ *</label>
                                        <input type="time" name="afterTime" value={formData.afterTime} onChange={handleInputChange} required />
                                    </div>
                                    <div className="form-group">
                                        <label>ÁÇπÂëºÊñπÊ≥ï</label>
                                        <select name="afterMethod" value={formData.afterMethod} onChange={handleInputChange}>
                                            <option>ÂØæÈù¢</option>
                                            <option>ÈõªË©±</option>
                                            <option>„Åù„ÅÆ‰ªñ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÁÇπÂëºÂü∑Ë°åËÄÖ</label>
                                        <input type="text" name="afterExecutor" value={formData.afterExecutor} onChange={handleInputChange} />
                                    </div>
                                    <div className="form-group">
                                        <label>„Ç¢„É´„Ç≥„Éº„É´Ê§úÁü•Âô®‰ΩøÁî®</label>
                                        <select name="afterAlcoholTest" value={formData.afterAlcoholTest} onChange={handleInputChange}>
                                            <option>Êúâ</option>
                                            <option>ÁÑ°</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÈÖíÊ∞óÂ∏Ø„Å≥</label>
                                        <select name="afterAlcohol" value={formData.afterAlcohol} onChange={handleInputChange}>
                                            <option>ÁÑ°</option>
                                            <option>Êúâ</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>ÈÅãË°åÁä∂Ê≥Å</label>
                                        <select name="afterStatus" value={formData.afterStatus} onChange={handleInputChange}>
                                            <option>Áï∞Â∏∏„Å™„Åó</option>
                                            <option>ÈÅÖÂª∂„ÅÇ„Çä</option>
                                            <option>‰∫ãÊïÖ„ÅÇ„Çä</option>
                                            <option>ÈÅïÂèç„ÅÇ„Çä</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>‰∫§ÊõøÈÅãËª¢ËÄÖ„Å∏„ÅÆÈÄöÂëä</label>
                                        <select name="afterHandover" value={formData.afterHandover} onChange={handleInputChange}>
                                            <option>„Å™„Åó</option>
                                            <option>„ÅÇ„Çä</option>
                                        </select>
                                    </div>
                                    <div className="form-group" style={{gridColumn: '1 / -1'}}>
                                        <label>„Åù„ÅÆ‰ªñÊåáÁ§∫‰∫ãÈ†Ö</label>
                                        <textarea name="afterOther" value={formData.afterOther} onChange={handleInputChange} rows="2"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div className="btn-group">
                                <button type="submit" className="btn btn-primary">
                                    {editingId ? 'Êõ¥Êñ∞„Åô„Çã' : 'Ë®òÈå≤„Çí‰øùÂ≠ò'}
                                </button>
                                {editingId && (
                                    <button type="button" className="btn btn-secondary" onClick={() => {
                                        setEditingId(null);
                                        const initialFormData = {
                                            date: new Date().toISOString().split('T')[0],
                                            companyName: '',
                                            officeName: '',
                                            driverName: '',
                                            vehicleNumber: '',
                                            beforeTime: '',
                                            beforeMethod: 'ÂØæÈù¢',
                                            beforeExecutor: '',
                                            beforeAlcoholTest: 'Êúâ',
                                            beforeAlcohol: 'ÁÑ°',
                                            beforeHealth: 'ËâØÂ•Ω',
                                            beforeInspection: 'ËâØÂ•Ω',
                                            beforeWeather: 'Êô¥',
                                            beforeOther: '',
                                            afterTime: '',
                                            afterMethod: 'ÂØæÈù¢',
                                            afterExecutor: '',
                                            afterAlcoholTest: 'Êúâ',
                                            afterAlcohol: 'ÁÑ°',
                                            afterStatus: 'Áï∞Â∏∏„Å™„Åó',
                                            afterHandover: '„Å™„Åó',
                                            afterOther: ''
                                        };
                                        setFormData(initialFormData);
                                    }}>
                                        „Ç≠„É£„É≥„Çª„É´
                                    </button>
                                )}
                            </div>
                        </form>

                        <div className="records-list">
                            <h2 style={{marginBottom: '20px', color: '#2d3748'}}>Ë®òÈå≤‰∏ÄË¶ß</h2>
                            
                            <div className="month-selector">
                                <label style={{fontWeight: '600'}}>ÊúàÂà•PDFÂá∫Âäõ:</label>
                                <select id="monthSelect" defaultValue={new Date().toISOString().slice(0, 7)}>
                                    {Array.from({length: 12}, (_, i) => {
                                        const d = new Date();
                                        d.setMonth(d.getMonth() - i);
                                        const monthStr = d.toISOString().slice(0, 7);
                                        return <option key={monthStr} value={monthStr}>{monthStr}</option>;
                                    })}
                                </select>
                                <button className="btn btn-tertiary" onClick={() => {
                                    const month = document.getElementById('monthSelect').value;
                                    generatePDF(month);
                                }}>
                                    PDFÂá∫Âäõ
                                </button>
                            </div>

                            {records.map(record => (
                                <div key={record.id} className="record-item">
                                    <div className="record-header">
                                        <div className="record-date">
                                            üìÖ {record.date} - {record.driverName} ({record.vehicleNumber})
                                        </div>
                                        <div className="record-actions">
                                            <button className="btn-small btn-edit" onClick={() => handleEdit(record)}>Á∑®ÈõÜ</button>
                                            <button className="btn-small btn-delete" onClick={() => handleDelete(record.id)}>ÂâäÈô§</button>
                                        </div>
                                    </div>
                                    <div className="record-details">
                                        <strong>Ê•≠ÂãôÂâç:</strong> {record.beforeTime} ({record.beforeMethod}) - ÂÅ•Â∫∑: {record.beforeHealth}<br/>
                                        <strong>Ê•≠ÂãôÂæå:</strong> {record.afterTime} ({record.afterMethod}) - Áä∂Ê≥Å: {record.afterStatus}
                                    </div>
                                </div>
                            ))}
                            
                            {records.length === 0 && (
                                <div style={{textAlign: 'center', padding: '40px', color: '#a0aec0'}}>
                                    „Åæ„Å†Ë®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
